let restaurant;var newMap;function ImgError(){this.classList.add("style-image-alt"),this.onmousemove=null}document.addEventListener("DOMContentLoaded",e=>{initMap()}),initMap=(()=>{fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1Ijoic2lkNyIsImEiOiJjamp1OGJvd2QwMzAzM3ByejRnd2x2NXY4In0.fkA6CjOQbzCkLVqJ1Wm4lA",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap))})}),fetchRestaurantFromURL=(e=>{if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(t,n)=>{self.restaurant=n,n?(fillRestaurantHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),imgHov=(({pageX:e,pageY:t,target:n})=>{const a=(e-n.offsetLeft)/n.width*100+"% "+(t-n.offsetTop)/n.height*100+"%";n.style.cssText="transform-origin: "+a}),fillRestaurantHTML=((e=self.restaurant)=>{document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;const t=document.getElementById("restaurant-img");t.className="restaurant-img",t.src=DBHelper.imageUrlForRestaurant(e.photograph),t.alt=`Image of ${e.name} Restaurant`,t.onmousemove=imgHov,t.onerror=ImgError,document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let n in e){const a=document.createElement("tr"),r=document.createElement("th");r.innerHTML=n,a.appendChild(r);const o=document.createElement("td");o.innerHTML=e[n],a.appendChild(o),t.appendChild(a)}}),fillReviewsHTML=((e=self.restaurant.reviews)=>{const t=document.getElementById("reviews-container"),n=document.createElement("h2");if(n.innerHTML="Reviews",t.appendChild(n),!e){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void t.appendChild(e)}const a=document.getElementById("reviews-list");e.forEach(e=>{a.appendChild(createReviewHTML(e))}),t.appendChild(a)}),star=(e=>["☆","☆","☆","☆","☆"].fill("★",0,e).join("")),createReviewHTML=(e=>{const t=document.createElement("li");t.setAttribute("tabindex",0),t.setAttribute("aria-label","Review");const n=document.createElement("p");n.setAttribute("aria-label","Review by"),n.innerHTML=e.name,t.appendChild(n);const a=document.createElement("p");a.innerHTML=e.date,a.setAttribute("aria-label","Review post date"),t.appendChild(a);const r=document.createElement("p");r.innerHTML=`Rating: <span>${star(e.rating)}</span>`,r.setAttribute("aria-label",`Review rating - ${e.rating}`),t.appendChild(r);const o=document.createElement("p");return o.innerHTML=e.comments,o.setAttribute("aria-label","Review text"),t.appendChild(o),t}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.querySelector("#breadcrumb ol"),n=document.createElement("li");n.innerHTML=e.name,n.setAttribute("aria-current","page"),t.appendChild(n)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibmV3TWFwIiwiSW1nRXJyb3IiLCJ0aGlzIiwiY2xhc3NMaXN0IiwiYWRkIiwib25tb3VzZW1vdmUiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImluaXRNYXAiLCJmZXRjaFJlc3RhdXJhbnRGcm9tVVJMIiwiZXJyb3IiLCJjb25zb2xlIiwic2VsZiIsIkwiLCJtYXAiLCJjZW50ZXIiLCJsYXRsbmciLCJsYXQiLCJsbmciLCJ6b29tIiwic2Nyb2xsV2hlZWxab29tIiwidGlsZUxheWVyIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiYXR0cmlidXRpb24iLCJpZCIsImFkZFRvIiwiZmlsbEJyZWFkY3J1bWIiLCJEQkhlbHBlciIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJjYWxsYmFjayIsImdldFBhcmFtZXRlckJ5TmFtZSIsImZldGNoUmVzdGF1cmFudEJ5SWQiLCJmaWxsUmVzdGF1cmFudEhUTUwiLCJpbWdIb3YiLCJwYWdlWCIsInBhZ2VZIiwidGFyZ2V0IiwiZWwiLCJvcmlnaW4iLCJvZmZzZXRMZWZ0Iiwid2lkdGgiLCJvZmZzZXRUb3AiLCJoZWlnaHQiLCJzdHlsZSIsImNzc1RleHQiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsIm5hbWUiLCJhZGRyZXNzIiwiaW1hZ2UiLCJjbGFzc05hbWUiLCJzcmMiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJwaG90b2dyYXBoIiwiYWx0Iiwib25lcnJvciIsImN1aXNpbmVfdHlwZSIsIm9wZXJhdGluZ19ob3VycyIsImZpbGxSZXN0YXVyYW50SG91cnNIVE1MIiwiZmlsbFJldmlld3NIVE1MIiwib3BlcmF0aW5nSG91cnMiLCJob3VycyIsImtleSIsInJvdyIsImNyZWF0ZUVsZW1lbnQiLCJkYXkiLCJhcHBlbmRDaGlsZCIsInRpbWUiLCJyZXZpZXdzIiwiY29udGFpbmVyIiwidGl0bGUiLCJub1Jldmlld3MiLCJ1bCIsImZvckVhY2giLCJyZXZpZXciLCJjcmVhdGVSZXZpZXdIVE1MIiwic3RhciIsInIiLCJmaWxsIiwiam9pbiIsImxpIiwic2V0QXR0cmlidXRlIiwiZGF0ZSIsInJhdGluZyIsImNvbW1lbnRzIiwiYnJlYWRjcnVtYiIsInF1ZXJ5U2VsZWN0b3IiLCJ1cmwiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJyZXBsYWNlIiwicmVzdWx0cyIsIlJlZ0V4cCIsImV4ZWMiLCJkZWNvZGVVUklDb21wb25lbnQiXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLFdBQ0osSUFBSUMsT0FxRkosU0FBU0MsV0FDUEMsS0FBS0MsVUFBVUMsSUFBSSxtQkFDbkJGLEtBQUtHLFlBQWMsS0FsRnJCQyxTQUFTQyxpQkFBaUIsbUJBQXFCQyxJQUM3Q0MsWUFNRkEsUUFBVSxNQUNSQyx1QkFBdUIsQ0FBQ0MsRUFBT1osS0FDekJZLEVBQ0ZDLFFBQVFELE1BQU1BLElBRWRFLEtBQUtiLE9BQVNjLEVBQUVDLElBQUksTUFBTyxDQUN6QkMsT0FBUSxDQUFDakIsRUFBV2tCLE9BQU9DLElBQUtuQixFQUFXa0IsT0FBT0UsS0FDbERDLEtBQU0sR0FDTkMsaUJBQWlCLElBRW5CUCxFQUFFUSxVQUFVLG9GQUFxRixDQUMvRkMsWUFBYSx3RkFDYkMsUUFBUyxHQUNUQyxZQUFhLDBOQUdiQyxHQUFJLG1CQUNIQyxNQUFNM0IsUUFDVDRCLGlCQUNBQyxTQUFTQyx1QkFBdUJqQixLQUFLZCxXQUFZYyxLQUFLYixhQXdCNURVLHVCQUF5QixDQUFDcUIsSUFDeEIsR0FBSWxCLEtBQUtkLFdBRVAsWUFEQWdDLEVBQVMsS0FBTWxCLEtBQUtkLFlBR3RCLE1BQU0yQixFQUFLTSxtQkFBbUIsTUFDekJOLEVBSUhHLFNBQVNJLG9CQUFvQlAsRUFBSSxDQUFDZixFQUFPWixLQUN2Q2MsS0FBS2QsV0FBYUEsRUFDYkEsR0FJTG1DLHFCQUNBSCxFQUFTLEtBQU1oQyxJQUpiYSxRQUFRRCxNQUFNQSxNQU5sQkEsTUFBUSww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QUFDN0IsRUFBV2MsS0FBS2QsY0FDaEMsTUFBTXdGLEVBQWFqRixTQUFTa0YsY0FBYyxrQkFDcENOLEVBQUs1RSxTQUFTNEQsY0FBYyxNQUNsQ2dCLEVBQUdsQyxVQUFZakQsRUFBV2tELEtBQzFCaUMsRUFBR0MsYUFBYSxlQUFnQixRQUNoQ0ksRUFBV25CLFlBQVljLEtBTXpCbEQsbUJBQXFCLEVBQUNpQixFQUFNd0MsS0FDckJBLElBQ0hBLEVBQU1DLE9BQU9DLFNBQVNDLE1BQ3hCM0MsRUFBT0EsRUFBSzRDLFFBQVEsVUFBVyxRQUMvQixNQUNFQyxFQURZLElBQUlDLGNBQWM5QyxzQkFDZCtDLEtBQUtQLEdBQ3ZCLE9BQUtLLEVBRUFBLEVBQVEsR0FFTkcsbUJBQW1CSCxFQUFRLEdBQUdELFFBQVEsTUFBTyxNQUQzQyxHQUZBIiwiZmlsZSI6InJlc3RhdXJhbnRfaW5mby5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCByZXN0YXVyYW50O1xyXG52YXIgbmV3TWFwO1xyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgbWFwIGFzIHNvb24gYXMgdGhlIHBhZ2UgaXMgbG9hZGVkLlxyXG4gKi9cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIChldmVudCkgPT4ge1xyXG4gIGluaXRNYXAoKTtcclxufSk7XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBsZWFmbGV0IG1hcFxyXG4gKi9cclxuaW5pdE1hcCA9ICgpID0+IHtcclxuICBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxmLm5ld01hcCA9IEwubWFwKCdtYXAnLCB7XHJcbiAgICAgICAgY2VudGVyOiBbcmVzdGF1cmFudC5sYXRsbmcubGF0LCByZXN0YXVyYW50LmxhdGxuZy5sbmddLFxyXG4gICAgICAgIHpvb206IDE2LFxyXG4gICAgICAgIHNjcm9sbFdoZWVsWm9vbTogZmFsc2VcclxuICAgICAgfSk7XHJcbiAgICAgIEwudGlsZUxheWVyKCdodHRwczovL2FwaS50aWxlcy5tYXBib3guY29tL3Y0L3tpZH0ve3p9L3t4fS97eX0uanBnNzA/YWNjZXNzX3Rva2VuPXttYXBib3hUb2tlbn0nLCB7XHJcbiAgICAgICAgbWFwYm94VG9rZW46ICdway5leUoxSWpvaWMybGtOeUlzSW1FaU9pSmphbXAxT0dKdmQyUXdNekF6TTNCeWVqUm5kMngyTlhZNEluMC5ma0E2Q2pPUWJ6Q2tMVnFKMVdtNGxBJyxcclxuICAgICAgICBtYXhab29tOiAxOCxcclxuICAgICAgICBhdHRyaWJ1dGlvbjogJ01hcCBkYXRhICZjb3B5OyA8YSBocmVmPVwiaHR0cHM6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvXCI+T3BlblN0cmVldE1hcDwvYT4gY29udHJpYnV0b3JzLCAnICtcclxuICAgICAgICAgICc8YSBocmVmPVwiaHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LXNhLzIuMC9cIj5DQy1CWS1TQTwvYT4sICcgK1xyXG4gICAgICAgICAgJ0ltYWdlcnkgwqkgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm1hcGJveC5jb20vXCI+TWFwYm94PC9hPicsXHJcbiAgICAgICAgaWQ6ICdtYXBib3guc3RyZWV0cydcclxuICAgICAgfSkuYWRkVG8obmV3TWFwKTtcclxuICAgICAgZmlsbEJyZWFkY3J1bWIoKTtcclxuICAgICAgREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubmV3TWFwKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLyogd2luZG93LmluaXRNYXAgPSAoKSA9PiB7XHJcbiAgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xyXG4gICAgICAgIHpvb206IDE2LFxyXG4gICAgICAgIGNlbnRlcjogcmVzdGF1cmFudC5sYXRsbmcsXHJcbiAgICAgICAgc2Nyb2xsd2hlZWw6IGZhbHNlXHJcbiAgICAgIH0pO1xyXG4gICAgICBmaWxsQnJlYWRjcnVtYigpO1xyXG4gICAgICBEQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHNlbGYucmVzdGF1cmFudCwgc2VsZi5tYXApO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59ICovXHJcblxyXG4vKipcclxuICogR2V0IGN1cnJlbnQgcmVzdGF1cmFudCBmcm9tIHBhZ2UgVVJMLlxyXG4gKi9cclxuZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCA9IChjYWxsYmFjaykgPT4ge1xyXG4gIGlmIChzZWxmLnJlc3RhdXJhbnQpIHsgLy8gcmVzdGF1cmFudCBhbHJlYWR5IGZldGNoZWQhXHJcbiAgICBjYWxsYmFjayhudWxsLCBzZWxmLnJlc3RhdXJhbnQpXHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIGNvbnN0IGlkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdpZCcpO1xyXG4gIGlmICghaWQpIHsgLy8gbm8gaWQgZm91bmQgaW4gVVJMXHJcbiAgICBlcnJvciA9ICdObyByZXN0YXVyYW50IGlkIGluIFVSTCdcclxuICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICB9IGVsc2Uge1xyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XHJcbiAgICAgIHNlbGYucmVzdGF1cmFudCA9IHJlc3RhdXJhbnQ7XHJcbiAgICAgIGlmICghcmVzdGF1cmFudCkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBmaWxsUmVzdGF1cmFudEhUTUwoKTtcclxuICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudClcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIHpvb20gYW5kIG1vdmUgaW1hZ2Ugb24gaG92ZXJcclxuICovXHJcbmltZ0hvdiA9ICh7cGFnZVgsIHBhZ2VZLCB0YXJnZXQ6IGVsfSkgPT4ge1xyXG4gIGNvbnN0IG9yaWdpbiA9ICgocGFnZVggLSBlbC5vZmZzZXRMZWZ0KSAvIGVsLndpZHRoKSAqIDEwMCArICclICcgKyAoKHBhZ2VZIC0gZWwub2Zmc2V0VG9wKSAvIGVsLmhlaWdodCkgKiAxMDAgKyclJztcclxuICBlbC5zdHlsZS5jc3NUZXh0ID0gJ3RyYW5zZm9ybS1vcmlnaW46ICcgKyBvcmlnaW47XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEltZ0Vycm9yKCkge1xyXG4gIHRoaXMuY2xhc3NMaXN0LmFkZChcInN0eWxlLWltYWdlLWFsdFwiKTtcclxuICB0aGlzLm9ubW91c2Vtb3ZlID0gbnVsbDtcclxufVxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlXHJcbiAqL1xyXG5maWxsUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1uYW1lJyk7XHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcblxyXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1hZGRyZXNzJyk7XHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XHJcbiAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1pbWcnKTtcclxuXHJcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcclxuICBpbWFnZS5zcmMgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudC5waG90b2dyYXBoKTtcclxuICBpbWFnZS5hbHQgPSBgSW1hZ2Ugb2YgJHtyZXN0YXVyYW50Lm5hbWV9IFJlc3RhdXJhbnRgO1xyXG4gIGltYWdlLm9ubW91c2Vtb3ZlID0gaW1nSG92O1xyXG4gIGltYWdlLm9uZXJyb3IgPSBJbWdFcnJvcjtcclxuXHJcbiAgY29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKTtcclxuICBjdWlzaW5lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuY3Vpc2luZV90eXBlO1xyXG5cclxuICAvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xyXG4gIGlmIChyZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vycykge1xyXG4gICAgZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwoKTtcclxuICB9XHJcbiAgLy8gZmlsbCByZXZpZXdzXHJcbiAgZmlsbFJldmlld3NIVE1MKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBvcGVyYXRpbmcgaG91cnMgSFRNTCB0YWJsZSBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwgPSAob3BlcmF0aW5nSG91cnMgPSBzZWxmLnJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSA9PiB7XHJcbiAgY29uc3QgaG91cnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1ob3VycycpO1xyXG4gIGZvciAobGV0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xyXG4gICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTtcclxuXHJcbiAgICBjb25zdCBkYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aCcpO1xyXG4gICAgZGF5LmlubmVySFRNTCA9IGtleTtcclxuICAgIHJvdy5hcHBlbmRDaGlsZChkYXkpO1xyXG5cclxuICAgIGNvbnN0IHRpbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xyXG4gICAgdGltZS5pbm5lckhUTUwgPSBvcGVyYXRpbmdIb3Vyc1trZXldO1xyXG4gICAgcm93LmFwcGVuZENoaWxkKHRpbWUpO1xyXG5cclxuICAgIGhvdXJzLmFwcGVuZENoaWxkKHJvdyk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFsbCByZXZpZXdzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuZmlsbFJldmlld3NIVE1MID0gKHJldmlld3MgPSBzZWxmLnJlc3RhdXJhbnQucmV2aWV3cykgPT4ge1xyXG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWNvbnRhaW5lcicpO1xyXG4gIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKTtcclxuICB0aXRsZS5pbm5lckhUTUwgPSAnUmV2aWV3cyc7XHJcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRpdGxlKTtcclxuXHJcbiAgaWYgKCFyZXZpZXdzKSB7XHJcbiAgICBjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICBub1Jldmlld3MuaW5uZXJIVE1MID0gJ05vIHJldmlld3MgeWV0ISc7XHJcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobm9SZXZpZXdzKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1saXN0Jyk7XHJcbiAgcmV2aWV3cy5mb3JFYWNoKHJldmlldyA9PiB7XHJcbiAgICB1bC5hcHBlbmRDaGlsZChjcmVhdGVSZXZpZXdIVE1MKHJldmlldykpO1xyXG4gIH0pO1xyXG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh1bCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiByYXRpbmdcclxuICogQHBhcmFtIHJcclxuICovXHJcbnN0YXIgPSByID0+IFsn4piGJywgJ+KYhicsICfimIYnLCAn4piGJywgJ+KYhiddLmZpbGwoJ+KYhScsIDAsIHIpLmpvaW4oJycpO1xyXG4vKipcclxuICogQ3JlYXRlIHJldmlldyBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5jcmVhdGVSZXZpZXdIVE1MID0gKHJldmlldykgPT4ge1xyXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICBsaS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgMCk7XHJcbiAgbGkuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ1JldmlldycpO1xyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgbmFtZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIFwiUmV2aWV3IGJ5XCIpO1xyXG4gIG5hbWUuaW5uZXJIVE1MID0gcmV2aWV3Lm5hbWU7XHJcbiAgbGkuYXBwZW5kQ2hpbGQobmFtZSk7XHJcblxyXG4gIGNvbnN0IGRhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgZGF0ZS5pbm5lckhUTUwgPSByZXZpZXcuZGF0ZTtcclxuICBkYXRlLnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgXCJSZXZpZXcgcG9zdCBkYXRlXCIpO1xyXG4gIGxpLmFwcGVuZENoaWxkKGRhdGUpO1xyXG5cclxuICBjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgcmF0aW5nLmlubmVySFRNTCA9IGBSYXRpbmc6IDxzcGFuPiR7c3RhcihyZXZpZXcucmF0aW5nKX08L3NwYW4+YDtcclxuICByYXRpbmcuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBgUmV2aWV3IHJhdGluZyAtICR7cmV2aWV3LnJhdGluZ31gKTtcclxuICBsaS5hcHBlbmRDaGlsZChyYXRpbmcpO1xyXG5cclxuICBjb25zdCBjb21tZW50cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBjb21tZW50cy5pbm5lckhUTUwgPSByZXZpZXcuY29tbWVudHM7XHJcbiAgY29tbWVudHMuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBcIlJldmlldyB0ZXh0XCIpO1xyXG4gIGxpLmFwcGVuZENoaWxkKGNvbW1lbnRzKTtcclxuXHJcbiAgcmV0dXJuIGxpO1xyXG59XHJcblxyXG4vKipcclxuICogQWRkIHJlc3RhdXJhbnQgbmFtZSB0byB0aGUgYnJlYWRjcnVtYiBuYXZpZ2F0aW9uIG1lbnVcclxuICovXHJcbmZpbGxCcmVhZGNydW1iID0gKHJlc3RhdXJhbnQ9c2VsZi5yZXN0YXVyYW50KSA9PiB7XHJcbiAgY29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNicmVhZGNydW1iIG9sJyk7XHJcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gIGxpLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcclxuICBsaS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWN1cnJlbnRcIiwgXCJwYWdlXCIpO1xyXG4gIGJyZWFkY3J1bWIuYXBwZW5kQ2hpbGQobGkpO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0IGEgcGFyYW1ldGVyIGJ5IG5hbWUgZnJvbSBwYWdlIFVSTC5cclxuICovXHJcbmdldFBhcmFtZXRlckJ5TmFtZSA9IChuYW1lLCB1cmwpID0+IHtcclxuICBpZiAoIXVybClcclxuICAgIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xyXG4gIG5hbWUgPSBuYW1lLnJlcGxhY2UoL1tcXFtcXF1dL2csICdcXFxcJCYnKTtcclxuICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFs/Jl0ke25hbWV9KD0oW14mI10qKXwmfCN8JClgKSxcclxuICAgIHJlc3VsdHMgPSByZWdleC5leGVjKHVybCk7XHJcbiAgaWYgKCFyZXN1bHRzKVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgaWYgKCFyZXN1bHRzWzJdKVxyXG4gICAgcmV0dXJuICcnO1xyXG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC9cXCsvZywgJyAnKSk7XHJcbn1cclxuIl19
