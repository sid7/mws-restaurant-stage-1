let restaurants,neighborhoods,cuisines;var newMap,markers=[];function ImgError(){this.classList.add("style-image-alt"),this.onmousemove=null}document.addEventListener("DOMContentLoaded",e=>{initMap(),fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods((e,t)=>{e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const s=document.createElement("option");s.innerHTML=e,s.value=e,t.append(s)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines((e,t)=>{e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const s=document.createElement("option");s.innerHTML=e,s.value=e,t.append(s)})}),initMap=(()=>{self.newMap=L.map("map",{center:[40.722216,-73.987501],zoom:12,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1Ijoic2lkNyIsImEiOiJjamp1OGJvd2QwMzAzM3ByejRnd2x2NXY4In0.fkA6CjOQbzCkLVqJ1Wm4lA",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),updateRestaurants()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),s=e.selectedIndex,n=t.selectedIndex,a=e[s].value,o=t[n].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(a,o,(e,t)=>{e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers&&self.markers.forEach(e=>e.remove()),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");e.forEach(e=>{t.append(createRestaurantHTML(e))}),addMarkersToMap()}),imgHov=(({pageX:e,pageY:t,target:s})=>{const n=(e-s.offsetLeft)/s.width*100+"% "+(t-s.offsetTop)/s.height*100+"%";s.style.cssText="transform-origin: "+n}),createRestaurantHTML=(e=>{const t=document.createElement("li"),s=document.createElement("div");t.setAttribute("tabindex",0),s.className="img-container";const n=document.createElement("img");n.className="restaurant-img",n.src=DBHelper.imageUrlForRestaurant(e.photograph),n.alt=`Image of ${e.name} Restaurant`,n.onmousemove=imgHov,n.onerror=ImgError,s.append(n),t.append(s);const a=document.createElement("h2");a.innerHTML=e.name,t.append(a);const o=document.createElement("p");o.innerHTML=e.neighborhood,t.append(o);const r=document.createElement("p");r.innerHTML=e.address,t.append(r);const i=document.createElement("a");return i.innerHTML="View Details",i.href=DBHelper.urlForRestaurant(e),i.setAttribute("aria-label",`Click to open ${e.name}'s details page`),t.append(i),t}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.newMap);t.on("click",function(){window.location.href=t.options.url}),self.markers.push(t)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJuZXdNYXAiLCJtYXJrZXJzIiwiSW1nRXJyb3IiLCJ0aGlzIiwiY2xhc3NMaXN0IiwiYWRkIiwib25tb3VzZW1vdmUiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImluaXRNYXAiLCJmZXRjaE5laWdoYm9yaG9vZHMiLCJmZXRjaEN1aXNpbmVzIiwiREJIZWxwZXIiLCJlcnJvciIsImNvbnNvbGUiLCJzZWxmIiwiZmlsbE5laWdoYm9yaG9vZHNIVE1MIiwic2VsZWN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJmb3JFYWNoIiwibmVpZ2hib3Job29kIiwib3B0aW9uIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsInZhbHVlIiwiYXBwZW5kIiwiZmlsbEN1aXNpbmVzSFRNTCIsImN1aXNpbmUiLCJMIiwibWFwIiwiY2VudGVyIiwiem9vbSIsInNjcm9sbFdoZWVsWm9vbSIsInRpbGVMYXllciIsIm1hcGJveFRva2VuIiwibWF4Wm9vbSIsImF0dHJpYnV0aW9uIiwiaWQiLCJhZGRUbyIsInVwZGF0ZVJlc3RhdXJhbnRzIiwiY1NlbGVjdCIsIm5TZWxlY3QiLCJjSW5kZXgiLCJzZWxlY3RlZEluZGV4IiwibkluZGV4IiwiZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kIiwicmVzZXRSZXN0YXVyYW50cyIsImZpbGxSZXN0YXVyYW50c0hUTUwiLCJtYXJrZXIiLCJyZW1vdmUiLCJ1bCIsInJlc3RhdXJhbnQiLCJjcmVhdGVSZXN0YXVyYW50SFRNTCIsImFkZE1hcmtlcnNUb01hcCIsImltZ0hvdiIsInBhZ2VYIiwicGFnZVkiLCJ0YXJnZXQiLCJlbCIsIm9yaWdpbiIsIm9mZnNldExlZnQiLCJ3aWR0aCIsIm9mZnNldFRvcCIsImhlaWdodCIsInN0eWxlIiwiY3NzVGV4dCIsImxpIiwiY29udGFpbmVyIiwic2V0QXR0cmlidXRlIiwiY2xhc3NOYW1lIiwiaW1hZ2UiLCJzcmMiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJwaG90b2dyYXBoIiwiYWx0IiwibmFtZSIsIm9uZXJyb3IiLCJhZGRyZXNzIiwibW9yZSIsImhyZWYiLCJ1cmxGb3JSZXN0YXVyYW50IiwibWFwTWFya2VyRm9yUmVzdGF1cmFudCIsIm9uIiwid2luZG93IiwibG9jYXRpb24iLCJvcHRpb25zIiwidXJsIiwicHVzaCJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsWUFDRkMsY0FDQUMsU0FDRixJQUFJQyxPQUNBQyxRQUFVLEdBOEpkLFNBQVNDLFdBQ1BDLEtBQUtDLFVBQVVDLElBQUksbUJBQ25CRixLQUFLRyxZQUFjLEtBM0pyQkMsU0FBU0MsaUJBQWlCLG1CQUFxQkMsSUFDN0NDLFVBQ0FDLHFCQUNBQyxrQkFNRkQsbUJBQXFCLE1BQ25CRSxTQUFTRixtQkFBbUIsQ0FBQ0csRUFBT2hCLEtBQzlCZ0IsRUFDRkMsUUFBUUQsTUFBTUEsSUFFZEUsS0FBS2xCLGNBQWdCQSxFQUNyQm1CLDZCQVFOQSxzQkFBd0IsRUFBQ25CLEVBQWdCa0IsS0FBS2xCLGlCQUM1QyxNQUFNb0IsRUFBU1gsU0FBU1ksZUFBZSx3QkFDdkNyQixFQUFjc0IsUUFBUUMsSUFDcEIsTUFBTUMsRUFBU2YsU0FBU2dCLGNBQWMsVUFDdENELEVBQU9FLFVBQVlILEVBQ25CQyxFQUFPRyxNQUFRSixFQUNmSCxFQUFPUSxPQUFPSixPQU9sQlYsY0FBZ0IsTUFDZEMsU0FBU0QsY0FBYyxDQUFDRSxFQUFPZixLQUN6QmUsRUFDRkMsUUFBUUQsTUFBTUEsSUFFZEUsS0FBS2pCLFNBQVdBLEVBQ2hCNEIsd0JBUU5BLGlCQUFtQixFQUFDNUIsRUFBV2lCLEtBQUtqQixZQUNsQyxNQUFNbUIsRUFBU1gsU0FBU1ksZUFBZSxtQkFFdkNwQixFQUFTcUIsUUFBUVEsSUFDZixNQUFNTixFQUFTZixTQUFTZ0IsY0FBYyxVQUN0Q0QsRUFBT0UsVUFBWUksRUFDbkJOLEVBQU9HLE1BQVFH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QU8vQixFQUFPcUMsUUFBUUMsTUFFeEN2RSxLQUFLZixRQUFRdUYsS0FBS3ZDIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgcmVzdGF1cmFudHMsXHJcbiAgbmVpZ2hib3Job29kcyxcclxuICBjdWlzaW5lc1xyXG52YXIgbmV3TWFwXHJcbnZhciBtYXJrZXJzID0gW11cclxuXHJcbi8qKlxyXG4gKiBGZXRjaCBuZWlnaGJvcmhvb2RzIGFuZCBjdWlzaW5lcyBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cclxuICovXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoZXZlbnQpID0+IHtcclxuICBpbml0TWFwKCk7IC8vIGFkZGVkXHJcbiAgZmV0Y2hOZWlnaGJvcmhvb2RzKCk7XHJcbiAgZmV0Y2hDdWlzaW5lcygpO1xyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBGZXRjaCBhbGwgbmVpZ2hib3Job29kcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5mZXRjaE5laWdoYm9yaG9vZHMgPSAoKSA9PiB7XHJcbiAgREJIZWxwZXIuZmV0Y2hOZWlnaGJvcmhvb2RzKChlcnJvciwgbmVpZ2hib3Job29kcykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvclxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGYubmVpZ2hib3Job29kcyA9IG5laWdoYm9yaG9vZHM7XHJcbiAgICAgIGZpbGxOZWlnaGJvcmhvb2RzSFRNTCgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogU2V0IG5laWdoYm9yaG9vZHMgSFRNTC5cclxuICovXHJcbmZpbGxOZWlnaGJvcmhvb2RzSFRNTCA9IChuZWlnaGJvcmhvb2RzID0gc2VsZi5uZWlnaGJvcmhvb2RzKSA9PiB7XHJcbiAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0Jyk7XHJcbiAgbmVpZ2hib3Job29kcy5mb3JFYWNoKG5laWdoYm9yaG9vZCA9PiB7XHJcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgIG9wdGlvbi5pbm5lckhUTUwgPSBuZWlnaGJvcmhvb2Q7XHJcbiAgICBvcHRpb24udmFsdWUgPSBuZWlnaGJvcmhvb2Q7XHJcbiAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbik7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBGZXRjaCBhbGwgY3Vpc2luZXMgYW5kIHNldCB0aGVpciBIVE1MLlxyXG4gKi9cclxuZmV0Y2hDdWlzaW5lcyA9ICgpID0+IHtcclxuICBEQkhlbHBlci5mZXRjaEN1aXNpbmVzKChlcnJvciwgY3Vpc2luZXMpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2VsZi5jdWlzaW5lcyA9IGN1aXNpbmVzO1xyXG4gICAgICBmaWxsQ3Vpc2luZXNIVE1MKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXQgY3Vpc2luZXMgSFRNTC5cclxuICovXHJcbmZpbGxDdWlzaW5lc0hUTUwgPSAoY3Vpc2luZXMgPSBzZWxmLmN1aXNpbmVzKSA9PiB7XHJcbiAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xyXG5cclxuICBjdWlzaW5lcy5mb3JFYWNoKGN1aXNpbmUgPT4ge1xyXG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XHJcbiAgICBvcHRpb24uaW5uZXJIVE1MID0gY3Vpc2luZTtcclxuICAgIG9wdGlvbi52YWx1ZSA9IGN1aXNpbmU7XHJcbiAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbik7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIGxlYWZsZXQgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxyXG4gKi9cclxuaW5pdE1hcCA9ICgpID0+IHtcclxuICBzZWxmLm5ld01hcCA9IEwubWFwKCdtYXAnLCB7XHJcbiAgICAgICAgY2VudGVyOiBbNDAuNzIyMjE2LCAtNzMuOTg3NTAxXSxcclxuICAgICAgICB6b29tOiAxMixcclxuICAgICAgICBzY3JvbGxXaGVlbFpvb206IGZhbHNlXHJcbiAgICAgIH0pO1xyXG4gIEwudGlsZUxheWVyKCdodHRwczovL2FwaS50aWxlcy5tYXBib3guY29tL3Y0L3tpZH0ve3p9L3t4fS97eX0uanBnNzA/YWNjZXNzX3Rva2VuPXttYXBib3hUb2tlbn0nLCB7XHJcbiAgICBtYXBib3hUb2tlbjogJ3BrLmV5SjFJam9pYzJsa055SXNJbUVpT2lKamFtcDFPR0p2ZDJRd016QXpNM0J5ZWpSbmQyeDJOWFk0SW4wLmZrQTZDak9RYnpDa0xWcUoxV200bEEnLFxyXG4gICAgbWF4Wm9vbTogMTgsXHJcbiAgICBhdHRyaWJ1dGlvbjogJ01hcCBkYXRhICZjb3B5OyA8YSBocmVmPVwiaHR0cHM6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvXCI+T3BlblN0cmVldE1hcDwvYT4gY29udHJpYnV0b3JzLCAnICtcclxuICAgICAgJzxhIGhyZWY9XCJodHRwczovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnktc2EvMi4wL1wiPkNDLUJZLVNBPC9hPiwgJyArXHJcbiAgICAgICdJbWFnZXJ5IMKpIDxhIGhyZWY9XCJodHRwczovL3d3dy5tYXBib3guY29tL1wiPk1hcGJveDwvYT4nLFxyXG4gICAgaWQ6ICdtYXBib3guc3RyZWV0cydcclxuICB9KS5hZGRUbyhuZXdNYXApO1xyXG5cclxuICB1cGRhdGVSZXN0YXVyYW50cygpO1xyXG59XHJcbi8qIHdpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xyXG4gIGxldCBsb2MgPSB7XHJcbiAgICBsYXQ6IDQwLjcyMjIxNixcclxuICAgIGxuZzogLTczLjk4NzUwMVxyXG4gIH07XHJcbiAgc2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xyXG4gICAgem9vbTogMTIsXHJcbiAgICBjZW50ZXI6IGxvYyxcclxuICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxyXG4gIH0pO1xyXG4gIHVwZGF0ZVJlc3RhdXJhbnRzKCk7XHJcbn0gKi9cclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgcGFnZSBhbmQgbWFwIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzLlxyXG4gKi9cclxudXBkYXRlUmVzdGF1cmFudHMgPSAoKSA9PiB7XHJcbiAgY29uc3QgY1NlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcclxuICBjb25zdCBuU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0Jyk7XHJcblxyXG4gIGNvbnN0IGNJbmRleCA9IGNTZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuICBjb25zdCBuSW5kZXggPSBuU2VsZWN0LnNlbGVjdGVkSW5kZXg7XHJcblxyXG4gIGNvbnN0IGN1aXNpbmUgPSBjU2VsZWN0W2NJbmRleF0udmFsdWU7XHJcbiAgY29uc3QgbmVpZ2hib3Job29kID0gblNlbGVjdFtuSW5kZXhdLnZhbHVlO1xyXG5cclxuICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kLCAoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlc2V0UmVzdGF1cmFudHMocmVzdGF1cmFudHMpO1xyXG4gICAgICBmaWxsUmVzdGF1cmFudHNIVE1MKCk7XHJcbiAgICB9XHJcbiAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIENsZWFyIGN1cnJlbnQgcmVzdGF1cmFudHMsIHRoZWlyIEhUTUwgYW5kIHJlbW92ZSB0aGVpciBtYXAgbWFya2Vycy5cclxuICovXHJcbnJlc2V0UmVzdGF1cmFudHMgPSAocmVzdGF1cmFudHMpID0+IHtcclxuICAvLyBSZW1vdmUgYWxsIHJlc3RhdXJhbnRzXHJcbiAgc2VsZi5yZXN0YXVyYW50cyA9IFtdO1xyXG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnRzLWxpc3QnKTtcclxuICB1bC5pbm5lckhUTUwgPSAnJztcclxuXHJcbiAgLy8gUmVtb3ZlIGFsbCBtYXAgbWFya2Vyc1xyXG4gIGlmIChzZWxmLm1hcmtlcnMpIHtcclxuICAgIHNlbGYubWFya2Vycy5mb3JFYWNoKG1hcmtlciA9PiBtYXJrZXIucmVtb3ZlKCkpO1xyXG4gIH1cclxuICBzZWxmLm1hcmtlcnMgPSBbXTtcclxuICBzZWxmLnJlc3RhdXJhbnRzID0gcmVzdGF1cmFudHM7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYWxsIHJlc3RhdXJhbnRzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuZmlsbFJlc3RhdXJhbnRzSFRNTCA9IChyZXN0YXVyYW50cyA9IHNlbGYucmVzdGF1cmFudHMpID0+IHtcclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIHVsLmFwcGVuZChjcmVhdGVSZXN0YXVyYW50SFRNTChyZXN0YXVyYW50KSk7XHJcbiAgfSk7XHJcbiAgYWRkTWFya2Vyc1RvTWFwKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiB6b29tIGFuZCBtb3ZlIGltYWdlIG9uIGhvdmVyXHJcbiAqL1xyXG5pbWdIb3YgPSAoe3BhZ2VYLCBwYWdlWSwgdGFyZ2V0OiBlbH0pID0+IHtcclxuICBjb25zdCBvcmlnaW4gPSAoKHBhZ2VYIC0gZWwub2Zmc2V0TGVmdCkgLyBlbC53aWR0aCkgKiAxMDAgKyAnJSAnICsgKChwYWdlWSAtIGVsLm9mZnNldFRvcCkgLyBlbC5oZWlnaHQpICogMTAwICsnJSc7XHJcbiAgZWwuc3R5bGUuY3NzVGV4dCA9ICd0cmFuc2Zvcm0tb3JpZ2luOiAnICsgb3JpZ2luO1xyXG59XHJcblxyXG5mdW5jdGlvbiBJbWdFcnJvcigpIHtcclxuICB0aGlzLmNsYXNzTGlzdC5hZGQoXCJzdHlsZS1pbWFnZS1hbHRcIik7XHJcbiAgdGhpcy5vbm1vdXNlbW92ZSA9IG51bGw7XHJcbn1cclxuLyoqXHJcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwuXHJcbiAqL1xyXG5jcmVhdGVSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50KSA9PiB7XHJcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gIGxpLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAwKTtcclxuICBjb250YWluZXIuY2xhc3NOYW1lID0gXCJpbWctY29udGFpbmVyXCI7XHJcblxyXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcclxuICBpbWFnZS5zcmMgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudC5waG90b2dyYXBoKTtcclxuICBpbWFnZS5hbHQgPSBgSW1hZ2Ugb2YgJHtyZXN0YXVyYW50Lm5hbWV9IFJlc3RhdXJhbnRgO1xyXG4gIGltYWdlLm9ubW91c2Vtb3ZlID0gaW1nSG92O1xyXG4gIGltYWdlLm9uZXJyb3IgPSBJbWdFcnJvcjtcclxuXHJcbiAgY29udGFpbmVyLmFwcGVuZChpbWFnZSk7XHJcbiAgbGkuYXBwZW5kKGNvbnRhaW5lcik7XHJcblxyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xyXG4gIG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xyXG4gIGxpLmFwcGVuZChuYW1lKTtcclxuXHJcbiAgY29uc3QgbmVpZ2hib3Job29kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIG5laWdoYm9yaG9vZC5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5laWdoYm9yaG9vZDtcclxuICBsaS5hcHBlbmQobmVpZ2hib3Job29kKTtcclxuXHJcbiAgY29uc3QgYWRkcmVzcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcclxuICBsaS5hcHBlbmQoYWRkcmVzcyk7XHJcblxyXG4gIGNvbnN0IG1vcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgbW9yZS5pbm5lckhUTUwgPSAnVmlldyBEZXRhaWxzJztcclxuICBtb3JlLmhyZWYgPSBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xyXG4gIG1vcmUuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBgQ2xpY2sgdG8gb3BlbiAke3Jlc3RhdXJhbnQubmFtZX0ncyBkZXRhaWxzIHBhZ2VgKTtcclxuICBsaS5hcHBlbmQobW9yZSlcclxuXHJcbiAgcmV0dXJuIGxpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBZGQgbWFya2VycyBmb3IgY3VycmVudCByZXN0YXVyYW50cyB0byB0aGUgbWFwLlxyXG4gKi9cclxuYWRkTWFya2Vyc1RvTWFwID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XHJcbiAgICAvLyBBZGQgbWFya2VyIHRvIHRoZSBtYXBcclxuICAgIGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2VsZi5uZXdNYXApO1xyXG4gICAgbWFya2VyLm9uKFwiY2xpY2tcIiwgb25DbGljayk7XHJcbiAgICBmdW5jdGlvbiBvbkNsaWNrKCkge1xyXG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IG1hcmtlci5vcHRpb25zLnVybDtcclxuICAgIH1cclxuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcik7XHJcbiAgfSk7XHJcblxyXG59XHJcbi8qIGFkZE1hcmtlcnNUb01hcCA9IChyZXN0YXVyYW50cyA9IHNlbGYucmVzdGF1cmFudHMpID0+IHtcclxuICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xyXG4gICAgLy8gQWRkIG1hcmtlciB0byB0aGUgbWFwXHJcbiAgICBjb25zdCBtYXJrZXIgPSBEQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIHNlbGYubWFwKTtcclxuICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IG1hcmtlci51cmxcclxuICAgIH0pO1xyXG4gICAgc2VsZi5tYXJrZXJzLnB1c2gobWFya2VyKTtcclxuICB9KTtcclxufSAqL1xyXG5cclxuIl19
