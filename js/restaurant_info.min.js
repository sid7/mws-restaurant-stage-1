let restaurant;var newMap;function ImgError(){this.classList.add("style-image-alt"),this.onmousemove=null}document.addEventListener("DOMContentLoaded",e=>{initMap()}),initMap=(()=>{fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1Ijoic2lkNyIsImEiOiJjamp1OGJvd2QwMzAzM3ByejRnd2x2NXY4In0.fkA6CjOQbzCkLVqJ1Wm4lA",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap))})}),fetchRestaurantFromURL=(e=>{if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(t,n)=>{self.restaurant=n,n?(fillRestaurantHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),imgHov=(({pageX:e,pageY:t,target:n})=>{const a=(e-n.offsetLeft)/n.width*100+"% "+(t-n.offsetTop)/n.height*100+"%";n.style.cssText="transform-origin: "+a}),fillRestaurantHTML=((e=self.restaurant)=>{document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;const t=document.getElementById("restaurant-img");t.className="restaurant-img",t.src=DBHelper.imageUrlForRestaurant(e.photograph),t.alt=`Image of ${e.name} Restaurant`,t.onmousemove=imgHov,t.onerror=ImgError,document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let n in e){const a=document.createElement("tr"),r=document.createElement("th");r.innerHTML=n,a.appendChild(r);const o=document.createElement("td");o.innerHTML=e[n],a.appendChild(o),t.appendChild(a)}}),fillReviewsHTML=((e=self.restaurant.reviews)=>{const t=document.getElementById("reviews-container"),n=document.createElement("h2");if(n.innerHTML="Reviews",t.appendChild(n),!e){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void t.appendChild(e)}const a=document.getElementById("reviews-list");e.forEach(e=>{a.appendChild(createReviewHTML(e))}),t.appendChild(a)}),star=(e=>["☆","☆","☆","☆","☆"].fill("★",0,e).join("")),createReviewHTML=(e=>{const t=document.createElement("li");t.setAttribute("tabindex",0),t.setAttribute("aria-label","Review");const n=document.createElement("p");n.setAttribute("aria-label","Review by"),n.innerHTML=e.name,t.appendChild(n);const a=document.createElement("p");a.innerHTML=e.date,a.setAttribute("aria-label","Review post date"),t.appendChild(a);const r=document.createElement("p");r.innerHTML=`Rating: <span>${star(e.rating)}</span>`,r.setAttribute("aria-label",`Review rating - ${e.rating}`),t.appendChild(r);const o=document.createElement("p");return o.innerHTML=e.comments,o.setAttribute("aria-label","Review text"),t.appendChild(o),t}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.querySelector("#breadcrumb ol"),n=document.createElement("li");n.innerHTML=e.name,n.setAttribute("aria-current","page"),t.appendChild(n)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibmV3TWFwIiwiSW1nRXJyb3IiLCJ0aGlzIiwiY2xhc3NMaXN0IiwiYWRkIiwib25tb3VzZW1vdmUiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImluaXRNYXAiLCJmZXRjaFJlc3RhdXJhbnRGcm9tVVJMIiwiZXJyb3IiLCJjb25zb2xlIiwic2VsZiIsIkwiLCJtYXAiLCJjZW50ZXIiLCJsYXRsbmciLCJsYXQiLCJsbmciLCJ6b29tIiwic2Nyb2xsV2hlZWxab29tIiwidGlsZUxheWVyIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiYXR0cmlidXRpb24iLCJpZCIsImFkZFRvIiwiZmlsbEJyZWFkY3J1bWIiLCJEQkhlbHBlciIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJjYWxsYmFjayIsImdldFBhcmFtZXRlckJ5TmFtZSIsImZldGNoUmVzdGF1cmFudEJ5SWQiLCJmaWxsUmVzdGF1cmFudEhUTUwiLCJpbWdIb3YiLCJwYWdlWCIsInBhZ2VZIiwidGFyZ2V0IiwiZWwiLCJvcmlnaW4iLCJvZmZzZXRMZWZ0Iiwid2lkdGgiLCJvZmZzZXRUb3AiLCJoZWlnaHQiLCJzdHlsZSIsImNzc1RleHQiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsIm5hbWUiLCJhZGRyZXNzIiwiaW1hZ2UiLCJjbGFzc05hbWUiLCJzcmMiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJwaG90b2dyYXBoIiwiYWx0Iiwib25lcnJvciIsImN1aXNpbmVfdHlwZSIsIm9wZXJhdGluZ19ob3VycyIsImZpbGxSZXN0YXVyYW50SG91cnNIVE1MIiwiZmlsbFJldmlld3NIVE1MIiwib3BlcmF0aW5nSG91cnMiLCJob3VycyIsImtleSIsInJvdyIsImNyZWF0ZUVsZW1lbnQiLCJkYXkiLCJhcHBlbmRDaGlsZCIsInRpbWUiLCJyZXZpZXdzIiwiY29udGFpbmVyIiwidGl0bGUiLCJub1Jldmlld3MiLCJ1bCIsImZvckVhY2giLCJyZXZpZXciLCJjcmVhdGVSZXZpZXdIVE1MIiwic3RhciIsInIiLCJmaWxsIiwiam9pbiIsImxpIiwic2V0QXR0cmlidXRlIiwiZGF0ZSIsInJhdGluZyIsImNvbW1lbnRzIiwiYnJlYWRjcnVtYiIsInF1ZXJ5U2VsZWN0b3IiLCJ1cmwiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJyZXBsYWNlIiwicmVzdWx0cyIsIlJlZ0V4cCIsImV4ZWMiLCJkZWNvZGVVUklDb21wb25lbnQiXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLFdBQ0osSUFBSUMsT0FxRkosU0FBU0MsV0FDUEMsS0FBS0MsVUFBVUMsSUFBSSxtQkFDbkJGLEtBQUtHLFlBQWMsS0FsRnJCQyxTQUFTQyxpQkFBaUIsbUJBQXFCQyxJQUM3Q0MsWUFNRkEsUUFBVSxNQUNSQyx1QkFBdUIsQ0FBQ0MsRUFBT1osS0FDekJZLEVBQ0ZDLFFBQVFELE1BQU1BLElBRWRFLEtBQUtiLE9BQVNjLEVBQUVDLElBQUksTUFBTyxDQUN6QkMsT0FBUSxDQUFDakIsRUFBV2tCLE9BQU9DLElBQUtuQixFQUFXa0IsT0FBT0UsS0FDbERDLEtBQU0sR0FDTkMsaUJBQWlCLElBRW5CUCxFQUFFUSxVQUFVLG9GQUFxRixDQUMvRkMsWUFBYSx3RkFDYkMsUUFBUyxHQUNUQyxZQUFhLDBOQUdiQyxHQUFJLG1CQUNIQyxNQUFNM0IsUUFDVDRCLGlCQUNBQyxTQUFTQyx1QkFBdUJqQixLQUFLZCxXQUFZYyxLQUFLYixhQXdCNURVLHVCQUF5QixDQUFDcUIsSUFDeEIsR0FBSWxCLEtBQUtkLFdBRVAsWUFEQWdDLEVBQVMsS0FBTWxCLEtBQUtkLFlBR3RCLE1BQU0yQixFQUFLTSxtQkFBbUIsTUFDekJOLEVBSUhHLFNBQVNJLG9CQUFvQlAsRUFBSSxDQUFDZixFQUFPWixLQUN2Q2MsS0FBS2QsV0FBYUEsRUFDYkEsR0FJTG1DLHFCQUNBSCxFQUFTLEtBQU1oQyxJQUpiYSxRQUFRRCxNQUFNQSxNQU5sQkEsTUFBUSww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QUFDN0IsRUFBV2MsS0FBS2QsY0FDaEMsTUFBTXdGLEVBQWFqRixTQUFTa0YsY0FBYyxrQkFDcENOLEVBQUs1RSxTQUFTNEQsY0FBYyxNQUNsQ2dCLEVBQUdsQyxVQUFZakQsRUFBV2tELEtBQzFCaUMsRUFBR0MsYUFBYSxlQUFnQixRQUNoQ0ksRUFBV25CLFlBQVljLEtBTXpCbEQsbUJBQXFCLEVBQUNpQixFQUFNd0MsS0FDckJBLElBQ0hBLEVBQU1DLE9BQU9DLFNBQVNDLE1BQ3hCM0MsRUFBT0EsRUFBSzRDLFFBQVEsVUFBVyxRQUMvQixNQUNFQyxFQURZLElBQUlDLGNBQWM5QyxzQkFDZCtDLEtBQUtQLEdBQ3ZCLE9BQUtLLEVBRUFBLEVBQVEsR0FFTkcsbUJBQW1CSCxFQUFRLEdBQUdELFFBQVEsTUFBTyxNQUQzQyxHQUZBIiwiZmlsZSI6InJlc3RhdXJhbnRfaW5mby5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgcmVzdGF1cmFudDtcclxudmFyIG5ld01hcDtcclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIG1hcCBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cclxuICovXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoZXZlbnQpID0+IHtcclxuICBpbml0TWFwKCk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgbGVhZmxldCBtYXBcclxuICovXHJcbmluaXRNYXAgPSAoKSA9PiB7XHJcbiAgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2VsZi5uZXdNYXAgPSBMLm1hcCgnbWFwJywge1xyXG4gICAgICAgIGNlbnRlcjogW3Jlc3RhdXJhbnQubGF0bG5nLmxhdCwgcmVzdGF1cmFudC5sYXRsbmcubG5nXSxcclxuICAgICAgICB6b29tOiAxNixcclxuICAgICAgICBzY3JvbGxXaGVlbFpvb206IGZhbHNlXHJcbiAgICAgIH0pO1xyXG4gICAgICBMLnRpbGVMYXllcignaHR0cHM6Ly9hcGkudGlsZXMubWFwYm94LmNvbS92NC97aWR9L3t6fS97eH0ve3l9LmpwZzcwP2FjY2Vzc190b2tlbj17bWFwYm94VG9rZW59Jywge1xyXG4gICAgICAgIG1hcGJveFRva2VuOiAncGsuZXlKMUlqb2ljMmxrTnlJc0ltRWlPaUpqYW1wMU9HSnZkMlF3TXpBek0zQnllalJuZDJ4Mk5YWTRJbjAuZmtBNkNqT1FiekNrTFZxSjFXbTRsQScsXHJcbiAgICAgICAgbWF4Wm9vbTogMTgsXHJcbiAgICAgICAgYXR0cmlidXRpb246ICdNYXAgZGF0YSAmY29weTsgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm9wZW5zdHJlZXRtYXAub3JnL1wiPk9wZW5TdHJlZXRNYXA8L2E+IGNvbnRyaWJ1dG9ycywgJyArXHJcbiAgICAgICAgICAnPGEgaHJlZj1cImh0dHBzOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1zYS8yLjAvXCI+Q0MtQlktU0E8L2E+LCAnICtcclxuICAgICAgICAgICdJbWFnZXJ5IMKpIDxhIGhyZWY9XCJodHRwczovL3d3dy5tYXBib3guY29tL1wiPk1hcGJveDwvYT4nLFxyXG4gICAgICAgIGlkOiAnbWFwYm94LnN0cmVldHMnXHJcbiAgICAgIH0pLmFkZFRvKG5ld01hcCk7XHJcbiAgICAgIGZpbGxCcmVhZGNydW1iKCk7XHJcbiAgICAgIERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQoc2VsZi5yZXN0YXVyYW50LCBzZWxmLm5ld01hcCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qIHdpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xyXG4gIGZldGNoUmVzdGF1cmFudEZyb21VUkwoKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcclxuICAgICAgICB6b29tOiAxNixcclxuICAgICAgICBjZW50ZXI6IHJlc3RhdXJhbnQubGF0bG5nLFxyXG4gICAgICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxyXG4gICAgICB9KTtcclxuICAgICAgZmlsbEJyZWFkY3J1bWIoKTtcclxuICAgICAgREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubWFwKTtcclxuICAgIH1cclxuICB9KTtcclxufSAqL1xyXG5cclxuLyoqXHJcbiAqIEdldCBjdXJyZW50IHJlc3RhdXJhbnQgZnJvbSBwYWdlIFVSTC5cclxuICovXHJcbmZldGNoUmVzdGF1cmFudEZyb21VUkwgPSAoY2FsbGJhY2spID0+IHtcclxuICBpZiAoc2VsZi5yZXN0YXVyYW50KSB7IC8vIHJlc3RhdXJhbnQgYWxyZWFkeSBmZXRjaGVkIVxyXG4gICAgY2FsbGJhY2sobnVsbCwgc2VsZi5yZXN0YXVyYW50KVxyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBjb25zdCBpZCA9IGdldFBhcmFtZXRlckJ5TmFtZSgnaWQnKTtcclxuICBpZiAoIWlkKSB7IC8vIG5vIGlkIGZvdW5kIGluIFVSTFxyXG4gICAgZXJyb3IgPSAnTm8gcmVzdGF1cmFudCBpZCBpbiBVUkwnXHJcbiAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgfSBlbHNlIHtcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xyXG4gICAgICBzZWxmLnJlc3RhdXJhbnQgPSByZXN0YXVyYW50O1xyXG4gICAgICBpZiAoIXJlc3RhdXJhbnQpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgZmlsbFJlc3RhdXJhbnRIVE1MKCk7XHJcbiAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpXHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiB6b29tIGFuZCBtb3ZlIGltYWdlIG9uIGhvdmVyXHJcbiAqL1xyXG5pbWdIb3YgPSAoe3BhZ2VYLCBwYWdlWSwgdGFyZ2V0OiBlbH0pID0+IHtcclxuICBjb25zdCBvcmlnaW4gPSAoKHBhZ2VYIC0gZWwub2Zmc2V0TGVmdCkgLyBlbC53aWR0aCkgKiAxMDAgKyAnJSAnICsgKChwYWdlWSAtIGVsLm9mZnNldFRvcCkgLyBlbC5oZWlnaHQpICogMTAwICsnJSc7XHJcbiAgZWwuc3R5bGUuY3NzVGV4dCA9ICd0cmFuc2Zvcm0tb3JpZ2luOiAnICsgb3JpZ2luO1xyXG59XHJcblxyXG5mdW5jdGlvbiBJbWdFcnJvcigpIHtcclxuICB0aGlzLmNsYXNzTGlzdC5hZGQoXCJzdHlsZS1pbWFnZS1hbHRcIik7XHJcbiAgdGhpcy5vbm1vdXNlbW92ZSA9IG51bGw7XHJcbn1cclxuLyoqXHJcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZVxyXG4gKi9cclxuZmlsbFJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcclxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtbmFtZScpO1xyXG4gIG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xyXG5cclxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtYWRkcmVzcycpO1xyXG4gIGFkZHJlc3MuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5hZGRyZXNzO1xyXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaW1nJyk7XHJcblxyXG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XHJcbiAgaW1hZ2Uuc3JjID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQucGhvdG9ncmFwaCk7XHJcbiAgaW1hZ2UuYWx0ID0gYEltYWdlIG9mICR7cmVzdGF1cmFudC5uYW1lfSBSZXN0YXVyYW50YDtcclxuICBpbWFnZS5vbm1vdXNlbW92ZSA9IGltZ0hvdjtcclxuICBpbWFnZS5vbmVycm9yID0gSW1nRXJyb3I7XHJcblxyXG4gIGNvbnN0IGN1aXNpbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1jdWlzaW5lJyk7XHJcbiAgY3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZTtcclxuXHJcbiAgLy8gZmlsbCBvcGVyYXRpbmcgaG91cnNcclxuICBpZiAocmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpIHtcclxuICAgIGZpbGxSZXN0YXVyYW50SG91cnNIVE1MKCk7XHJcbiAgfVxyXG4gIC8vIGZpbGwgcmV2aWV3c1xyXG4gIGZpbGxSZXZpZXdzSFRNTCgpO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgb3BlcmF0aW5nIGhvdXJzIEhUTUwgdGFibGUgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmZpbGxSZXN0YXVyYW50SG91cnNIVE1MID0gKG9wZXJhdGluZ0hvdXJzID0gc2VsZi5yZXN0YXVyYW50Lm9wZXJhdGluZ19ob3VycykgPT4ge1xyXG4gIGNvbnN0IGhvdXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaG91cnMnKTtcclxuICBmb3IgKGxldCBrZXkgaW4gb3BlcmF0aW5nSG91cnMpIHtcclxuICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XHJcblxyXG4gICAgY29uc3QgZGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGgnKTtcclxuICAgIGRheS5pbm5lckhUTUwgPSBrZXk7XHJcbiAgICByb3cuYXBwZW5kQ2hpbGQoZGF5KTtcclxuXHJcbiAgICBjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcclxuICAgIHRpbWUuaW5uZXJIVE1MID0gb3BlcmF0aW5nSG91cnNba2V5XTtcclxuICAgIHJvdy5hcHBlbmRDaGlsZCh0aW1lKTtcclxuXHJcbiAgICBob3Vycy5hcHBlbmRDaGlsZChyb3cpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBhbGwgcmV2aWV3cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmZpbGxSZXZpZXdzSFRNTCA9IChyZXZpZXdzID0gc2VsZi5yZXN0YXVyYW50LnJldmlld3MpID0+IHtcclxuICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1jb250YWluZXInKTtcclxuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XHJcbiAgdGl0bGUuaW5uZXJIVE1MID0gJ1Jldmlld3MnO1xyXG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aXRsZSk7XHJcblxyXG4gIGlmICghcmV2aWV3cykge1xyXG4gICAgY29uc3Qgbm9SZXZpZXdzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gICAgbm9SZXZpZXdzLmlubmVySFRNTCA9ICdObyByZXZpZXdzIHlldCEnO1xyXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKG5vUmV2aWV3cyk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtbGlzdCcpO1xyXG4gIHJldmlld3MuZm9yRWFjaChyZXZpZXcgPT4ge1xyXG4gICAgdWwuYXBwZW5kQ2hpbGQoY3JlYXRlUmV2aWV3SFRNTChyZXZpZXcpKTtcclxuICB9KTtcclxuICBjb250YWluZXIuYXBwZW5kQ2hpbGQodWwpO1xyXG59XHJcblxyXG4vKipcclxuICogcmF0aW5nXHJcbiAqIEBwYXJhbSByXHJcbiAqL1xyXG5zdGFyID0gciA9PiBbJ+KYhicsICfimIYnLCAn4piGJywgJ+KYhicsICfimIYnXS5maWxsKCfimIUnLCAwLCByKS5qb2luKCcnKTtcclxuLyoqXHJcbiAqIENyZWF0ZSByZXZpZXcgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuY3JlYXRlUmV2aWV3SFRNTCA9IChyZXZpZXcpID0+IHtcclxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgbGkuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIDApO1xyXG4gIGxpLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdSZXZpZXcnKTtcclxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIG5hbWUuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBcIlJldmlldyBieVwiKTtcclxuICBuYW1lLmlubmVySFRNTCA9IHJldmlldy5uYW1lO1xyXG4gIGxpLmFwcGVuZENoaWxkKG5hbWUpO1xyXG5cclxuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIGRhdGUuaW5uZXJIVE1MID0gcmV2aWV3LmRhdGU7XHJcbiAgZGF0ZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIFwiUmV2aWV3IHBvc3QgZGF0ZVwiKTtcclxuICBsaS5hcHBlbmRDaGlsZChkYXRlKTtcclxuXHJcbiAgY29uc3QgcmF0aW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIHJhdGluZy5pbm5lckhUTUwgPSBgUmF0aW5nOiA8c3Bhbj4ke3N0YXIocmV2aWV3LnJhdGluZyl9PC9zcGFuPmA7XHJcbiAgcmF0aW5nLnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgYFJldmlldyByYXRpbmcgLSAke3Jldmlldy5yYXRpbmd9YCk7XHJcbiAgbGkuYXBwZW5kQ2hpbGQocmF0aW5nKTtcclxuXHJcbiAgY29uc3QgY29tbWVudHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgY29tbWVudHMuaW5uZXJIVE1MID0gcmV2aWV3LmNvbW1lbnRzO1xyXG4gIGNvbW1lbnRzLnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgXCJSZXZpZXcgdGV4dFwiKTtcclxuICBsaS5hcHBlbmRDaGlsZChjb21tZW50cyk7XHJcblxyXG4gIHJldHVybiBsaTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEFkZCByZXN0YXVyYW50IG5hbWUgdG8gdGhlIGJyZWFkY3J1bWIgbmF2aWdhdGlvbiBtZW51XHJcbiAqL1xyXG5maWxsQnJlYWRjcnVtYiA9IChyZXN0YXVyYW50PXNlbGYucmVzdGF1cmFudCkgPT4ge1xyXG4gIGNvbnN0IGJyZWFkY3J1bWIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYnJlYWRjcnVtYiBvbCcpO1xyXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICBsaS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcbiAgbGkuc2V0QXR0cmlidXRlKFwiYXJpYS1jdXJyZW50XCIsIFwicGFnZVwiKTtcclxuICBicmVhZGNydW1iLmFwcGVuZENoaWxkKGxpKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCBhIHBhcmFtZXRlciBieSBuYW1lIGZyb20gcGFnZSBVUkwuXHJcbiAqL1xyXG5nZXRQYXJhbWV0ZXJCeU5hbWUgPSAobmFtZSwgdXJsKSA9PiB7XHJcbiAgaWYgKCF1cmwpXHJcbiAgICB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcclxuICBuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXFxdXS9nLCAnXFxcXCQmJyk7XHJcbiAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBbPyZdJHtuYW1lfSg9KFteJiNdKil8JnwjfCQpYCksXHJcbiAgICByZXN1bHRzID0gcmVnZXguZXhlYyh1cmwpO1xyXG4gIGlmICghcmVzdWx0cylcclxuICAgIHJldHVybiBudWxsO1xyXG4gIGlmICghcmVzdWx0c1syXSlcclxuICAgIHJldHVybiAnJztcclxuICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHJlc3VsdHNbMl0ucmVwbGFjZSgvXFwrL2csICcgJykpO1xyXG59XHJcbiJdfQ==
