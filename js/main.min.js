var restaurants,neighborhoods,cuisines,newMap,markers=[];function ImgError(){this.classList.add("style-image-alt"),this.onmousemove=null}function toggleFav(){const e=this.classList.contains("yes");DBHelper.fav(this.dataset.id,!e),this.classList.toggle("yes");const[t,a]=e?["add","remove"]:["remove","add"];this.setAttribute("aria-label",this.getAttribute("aria-label").replace(t,a))}document.addEventListener("DOMContentLoaded",()=>{initMap(),fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods((e,t)=>{e?console.error(e):(neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines((e,t)=>{e?console.error(e):(cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})}),initMap=(()=>{newMap=L.map("map",{center:[40.722216,-73.987501],zoom:12,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1Ijoic2lkNyIsImEiOiJjamp1OGJvd2QwMzAzM3ByejRnd2x2NXY4In0.fkA6CjOQbzCkLVqJ1Wm4lA",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),updateRestaurants()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),a=e.selectedIndex,o=t.selectedIndex,s=e[a].value,n=t[o].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(s,n,(e,t)=>{e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})}),resetRestaurants=(e=>{restaurants=[],document.getElementById("restaurants-list").innerHTML="",markers&&markers.forEach(e=>e.remove()),markers=[],restaurants=e}),fillRestaurantsHTML=((e=restaurants)=>{const t=document.getElementById("restaurants-list");e.forEach(e=>{t.append(createRestaurantHTML(e))}),addMarkersToMap()}),imgHov=(({pageX:e,pageY:t,target:a})=>{const o=(e-a.offsetLeft)/a.width*100+"% "+(t-a.offsetTop)/a.height*100+"%";a.style.cssText="transform-origin: "+o}),createRestaurantHTML=(e=>{const t=document.createElement("li"),a=document.createElement("div");t.setAttribute("tabindex",0),a.className="img-container";const o=document.createElement("img");o.className="restaurant-img",o.src=DBHelper.imageUrlForRestaurant(e.photograph),o.alt=`Image of ${e.name} Restaurant`,o.onmousemove=imgHov,o.onerror=ImgError,a.append(o),t.append(a);const s=document.createElement("h2");s.innerHTML=e.name,t.append(s);const n=document.createElement("button");n.textContent="❤";let r=!!e.is_favorite&&JSON.parse(e.is_favorite);const i=localStorage.getItem("loc_rest_fav");i&&(r=JSON.parse(i)[e.id]||r),n.className="is-fav"+(r?" yes":""),n.dataset.id=e.id,n.onclick=toggleFav,n.setAttribute("aria-label",`click to ${r?"remove":"add"} ${e.name} to favorite`),s.append(n);const c=document.createElement("p");c.innerHTML=e.neighborhood,t.append(c);const l=document.createElement("p");l.innerHTML=e.address,t.append(l);const d=document.createElement("a");return d.innerHTML="View Details",d.href=DBHelper.urlForRestaurant(e),d.setAttribute("aria-label",`Click to open ${e.name}'s details page`),t.append(d),t}),addMarkersToMap=((e=restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,newMap);t.on("click",function(){window.location.href=t.options.url}),markers.push(t)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJuZXdNYXAiLCJtYXJrZXJzIiwiSW1nRXJyb3IiLCJ0aGlzIiwiY2xhc3NMaXN0IiwiYWRkIiwib25tb3VzZW1vdmUiLCJ0b2dnbGVGYXYiLCJzdGF0ZSIsImNvbnRhaW5zIiwiREJIZWxwZXIiLCJmYXYiLCJkYXRhc2V0IiwiaWQiLCJ0b2dnbGUiLCJhIiwiYiIsInNldEF0dHJpYnV0ZSIsImdldEF0dHJpYnV0ZSIsInJlcGxhY2UiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJpbml0TWFwIiwiZmV0Y2hOZWlnaGJvcmhvb2RzIiwiZmV0Y2hDdWlzaW5lcyIsImVycm9yIiwibiIsImNvbnNvbGUiLCJmaWxsTmVpZ2hib3Job29kc0hUTUwiLCJzZWxlY3QiLCJnZXRFbGVtZW50QnlJZCIsImZvckVhY2giLCJuZWlnaGJvcmhvb2QiLCJvcHRpb24iLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwidmFsdWUiLCJhcHBlbmQiLCJjIiwiZmlsbEN1aXNpbmVzSFRNTCIsImN1aXNpbmUiLCJMIiwibWFwIiwiY2VudGVyIiwiem9vbSIsInNjcm9sbFdoZWVsWm9vbSIsInRpbGVMYXllciIsIm1hcGJveFRva2VuIiwibWF4Wm9vbSIsImF0dHJpYnV0aW9uIiwiYWRkVG8iLCJ1cGRhdGVSZXN0YXVyYW50cyIsImNTZWxlY3QiLCJuU2VsZWN0IiwiY0luZGV4Iiwic2VsZWN0ZWRJbmRleCIsIm5JbmRleCIsImZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZCIsInJlc3RzIiwicmVzZXRSZXN0YXVyYW50cyIsImZpbGxSZXN0YXVyYW50c0hUTUwiLCJtYXJrZXIiLCJyZW1vdmUiLCJ1bCIsInJlc3QiLCJjcmVhdGVSZXN0YXVyYW50SFRNTCIsImFkZE1hcmtlcnNUb01hcCIsImltZ0hvdiIsInBhZ2VYIiwicGFnZVkiLCJ0YXJnZXQiLCJlbCIsIm9yaWdpbiIsIm9mZnNldExlZnQiLCJ3aWR0aCIsIm9mZnNldFRvcCIsImhlaWdodCIsInN0eWxlIiwiY3NzVGV4dCIsImxpIiwiY29udGFpbmVyIiwiY2xhc3NOYW1lIiwiaW1hZ2UiLCJzcmMiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJwaG90b2dyYXBoIiwiYWx0IiwibmFtZSIsIm9uZXJyb3IiLCJ0ZXh0Q29udGVudCIsImlzRmF2IiwiaXNfZmF2b3JpdGUiLCJKU09OIiwicGFyc2UiLCJsb2NGYXZzIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsIm9uY2xpY2siLCJuZWlnaGJvcmhvb2RIVE1MIiwiYWRkcmVzcyIsIm1vcmUiLCJocmVmIiwidXJsRm9yUmVzdGF1cmFudCIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJvbiIsIndpbmRvdyIsImxvY2F0aW9uIiwib3B0aW9ucyIsInVybCIsInB1c2giXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLFlBQWFDLGNBQWVDLFNBQzVCQyxPQUNBQyxRQUFVLEdBZ0tkLFNBQVNDLFdBQ1BDLEtBQUtDLFVBQVVDLElBQUksbUJBQ25CRixLQUFLRyxZQUFjLEtBRXJCLFNBQVNDLFlBQ1AsTUFBTUMsRUFBUUwsS0FBS0MsVUFBVUssU0FBUyxPQUN0Q0MsU0FBU0MsSUFBSVIsS0FBS1MsUUFBUUMsSUFBS0wsR0FDL0JMLEtBQUtDLFVBQVVVLE9BQU8sT0FDdEIsTUFBT0MsRUFBR0MsR0FBS1IsRUFBUSxDQUFDLE1BQU8sVUFBWSxDQUFDLFNBQVUsT0FDdERMLEtBQUtjLGFBQWEsYUFBY2QsS0FBS2UsYUFBYSxjQUFjQyxRQUFRSixFQUFHQyxJQXBLN0VJLFNBQVNDLGlCQUFpQixtQkFBb0IsS0FDNUNDLFVBQ0FDLHFCQUNBQyxrQkFNRkQsbUJBQXFCLE1BQ25CYixTQUFTYSxtQkFBbUIsQ0FBQ0UsRUFBT0MsS0FDOUJELEVBRUZFLFFBQVFGLE1BQU1BLElBRWQzQixjQUFnQjRCLEVBQ2hCRSw2QkFRTkEsc0JBQXdCLEVBQUNGLEVB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QUNESixFQUFRRSxLQUFLQyxNQUFNQyxHQUFTOUIsRUFBS25ELEtBQU82RSxHQUUxQy9FLEVBQUlzRSxVQUFZLFVBQVlTLEVBQVEsT0FBUyxJQUM3Qy9FLEVBQUlDLFFBQVFDLEdBQUttRCxFQUFLbkQsR0FDdEJGLEVBQUlzRixRQUFVMUYsVUFDZEksRUFBSU0sYUFDRix5QkFDWXlFLEVBQVEsU0FBVyxTQUFTMUIsRUFBS3VCLG9CQUUvQ0EsRUFBS2xELE9BQU8xQixHQUVaLE1BQU11RixFQUFtQjlFLFNBQVNjLGNBQWMsS0FDaERnRSxFQUFpQi9ELFVBQVk2QixFQUFLaEMsYUFDbEMrQyxFQUFHMUMsT0FBTzZELEdBRVYsTUFBTUMsRUFBVS9FLFNBQVNjLGNBQWMsS0FDdkNpRSxFQUFRaEUsVUFBWTZCLEVBQUttQyxRQUN6QnBCLEVBQUcxQyxPQUFPOEQsR0FFVixNQUFNQyxFQUFPaEYsU0FBU2MsY0FBYyxLQU1wQyxPQUxBa0UsRUFBS2pFLFVBQVksZUFDakJpRSxFQUFLQyxLQUFPM0YsU0FBUzRGLGlCQUFpQnRDLEdBQ3RDb0MsRUFBS25GLGFBQWEsOEJBQStCK0MsRUFBS3VCLHVCQUN0RFIsRUFBRzFDLE9BQU8rRCxHQUVIckIsSUFNVGIsZ0JBQWtCLEVBQUNSLEVBQVE3RCxlQUN6QjZELEVBQU0zQixRQUFRaUMsSUFFWixNQUFNSCxFQUFTbkQsU0FBUzZGLHVCQUF1QnZDLEVBQU1oRSxRQUNyRDZELEVBQU8yQyxHQUFHLFFBQ1YsV0FDRUMsT0FBT0MsU0FBU0wsS0FBT3hDLEVBQU84QyxRQUFRQyxNQUV4QzNHLFFBQVE0RyxLQUFLaEQiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgcmVzdGF1cmFudHMsIG5laWdoYm9yaG9vZHMsIGN1aXNpbmVzO1xyXG52YXIgbmV3TWFwO1xyXG52YXIgbWFya2VycyA9IFtdO1xyXG5cclxuLyoqXHJcbiAqIEZldGNoIG5laWdoYm9yaG9vZHMgYW5kIGN1aXNpbmVzIGFzIHNvb24gYXMgdGhlIHBhZ2UgaXMgbG9hZGVkLlxyXG4gKi9cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4ge1xyXG4gIGluaXRNYXAoKTsgLy8gYWRkZWRcclxuICBmZXRjaE5laWdoYm9yaG9vZHMoKTtcclxuICBmZXRjaEN1aXNpbmVzKCk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIGFuZCBzZXQgdGhlaXIgSFRNTC5cclxuICovXHJcbmZldGNoTmVpZ2hib3Job29kcyA9ICgpID0+IHtcclxuICBEQkhlbHBlci5mZXRjaE5laWdoYm9yaG9vZHMoKGVycm9yLCBuKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgLy8gR290IGFuIGVycm9yXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbmVpZ2hib3Job29kcyA9IG47XHJcbiAgICAgIGZpbGxOZWlnaGJvcmhvb2RzSFRNTCgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFNldCBuZWlnaGJvcmhvb2RzIEhUTUwuXHJcbiAqL1xyXG5maWxsTmVpZ2hib3Job29kc0hUTUwgPSAobiA9IG5laWdoYm9yaG9vZHMpID0+IHtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5laWdoYm9yaG9vZHMtc2VsZWN0XCIpO1xyXG4gIG4uZm9yRWFjaChuZWlnaGJvcmhvb2QgPT4ge1xyXG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcclxuICAgIG9wdGlvbi5pbm5lckhUTUwgPSBuZWlnaGJvcmhvb2Q7XHJcbiAgICBvcHRpb24udmFsdWUgPSBuZWlnaGJvcmhvb2Q7XHJcbiAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbik7XHJcbiAgfSk7XHJcbn07XHJcblxyXG4vKipcclxuICogRmV0Y2ggYWxsIGN1aXNpbmVzIGFuZCBzZXQgdGhlaXIgSFRNTC5cclxuICovXHJcbmZldGNoQ3Vpc2luZXMgPSAoKSA9PiB7XHJcbiAgREJIZWxwZXIuZmV0Y2hDdWlzaW5lcygoZXJyb3IsIGMpID0+IHtcclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY3Vpc2luZXMgPSBjO1xyXG4gICAgICBmaWxsQ3Vpc2luZXNIVE1MKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn07XHJcblxyXG4vKipcclxuICogU2V0IGN1aXNpbmVzIEhUTUwuXHJcbiAqL1xyXG5maWxsQ3Vpc2luZXNIVE1MID0gKGMgPSBjdWlzaW5lcykgPT4ge1xyXG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY3Vpc2luZXMtc2VsZWN0XCIpO1xyXG5cclxuICBjLmZvckVhY2goY3Vpc2luZSA9PiB7XHJcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpO1xyXG4gICAgb3B0aW9uLmlubmVySFRNTCA9IGN1aXNpbmU7XHJcbiAgICBvcHRpb24udmFsdWUgPSBjdWlzaW5lO1xyXG4gICAgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgbGVhZmxldCBtYXAsIGNhbGxlZCBmcm9tIEhUTUwuXHJcbiAqL1xyXG5pbml0TWFwID0gKCkgPT4ge1xyXG4gIG5ld01hcCA9IEwubWFwKCdtYXAnLCB7XHJcbiAgICBjZW50ZXI6IFs0MC43MjIyMTYsIC03My45ODc1MDFdLFxyXG4gICAgem9vbTogMTIsXHJcbiAgICBzY3JvbGxXaGVlbFpvb206IGZhbHNlXHJcbiAgfSk7XHJcbiAgTC50aWxlTGF5ZXIoJ2h0dHBzOi8vYXBpLnRpbGVzLm1hcGJveC5jb20vdjQve2lkfS97en0ve3h9L3t5fS5qcGc3MD9hY2Nlc3NfdG9rZW49e21hcGJveFRva2VufScsIHtcclxuICAgIG1hcGJveFRva2VuOiAncGsuZXlKMUlqb2ljMmxrTnlJc0ltRWlPaUpqYW1wMU9HSnZkMlF3TXpBek0zQnllalJuZDJ4Mk5YWTRJbjAuZmtBNkNqT1FiekNrTFZxSjFXbTRsQScsXHJcbiAgICBtYXhab29tOiAxOCxcclxuICAgIGF0dHJpYnV0aW9uOiAnTWFwIGRhdGEgJmNvcHk7IDxhIGhyZWY9XCJodHRwczovL3d3dy5vcGVuc3RyZWV0bWFwLm9yZy9cIj5PcGVuU3RyZWV0TWFwPC9hPiBjb250cmlidXRvcnMsICcgK1xyXG4gICAgICAnPGEgaHJlZj1cImh0dHBzOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1zYS8yLjAvXCI+Q0MtQlktU0E8L2E+LCAnICtcclxuICAgICAgJ0ltYWdlcnkgwqkgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm1hcGJveC5jb20vXCI+TWFwYm94PC9hPicsXHJcbiAgICBpZDogJ21hcGJveC5zdHJlZXRzJ1xyXG4gIH0pLmFkZFRvKG5ld01hcCk7XHJcblxyXG4gIHVwZGF0ZVJlc3RhdXJhbnRzKCk7XHJcbn1cclxuLyogd2luZG93LmluaXRNYXAgPSAoKSA9PiB7XHJcbiAgbGV0IGxvYyA9IHtcclxuICAgIGxhdDogNDAuNzIyMjE2LFxyXG4gICAgbG5nOiAtNzMuOTg3NTAxXHJcbiAgfTtcclxuICBzZWxmLm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XHJcbiAgICB6b29tOiAxMixcclxuICAgIGNlbnRlcjogbG9jLFxyXG4gICAgc2Nyb2xsd2hlZWw6IGZhbHNlXHJcbiAgfSk7XHJcbiAgdXBkYXRlUmVzdGF1cmFudHMoKTtcclxufSAqL1xyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBwYWdlIGFuZCBtYXAgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMuXHJcbiAqL1xyXG51cGRhdGVSZXN0YXVyYW50cyA9ICgpID0+IHtcclxuICBjb25zdCBjU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xyXG4gIGNvbnN0IG5TZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcclxuXHJcbiAgY29uc3QgY0luZGV4ID0gY1NlbGVjdC5zZWxlY3RlZEluZGV4O1xyXG4gIGNvbnN0IG5JbmRleCA9IG5TZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuXHJcbiAgY29uc3QgYyA9IGNTZWxlY3RbY0luZGV4XS52YWx1ZTtcclxuICBjb25zdCBuID0gblNlbGVjdFtuSW5kZXhdLnZhbHVlO1xyXG5cclxuICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoYywgbiwgKGVycm9yLCByZXN0cykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXNldFJlc3RhdXJhbnRzKHJlc3RzKTtcclxuICAgICAgZmlsbFJlc3RhdXJhbnRzSFRNTCgpO1xyXG4gICAgfVxyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDbGVhciBjdXJyZW50IHJlc3RhdXJhbnRzLCB0aGVpciBIVE1MIGFuZCByZW1vdmUgdGhlaXIgbWFwIG1hcmtlcnMuXHJcbiAqL1xyXG5yZXNldFJlc3RhdXJhbnRzID0gcmVzdHMgPT4ge1xyXG4gIC8vIFJlbW92ZSBhbGwgcmVzdGF1cmFudHNcclxuICByZXN0YXVyYW50cyA9IFtdO1xyXG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXN0YXVyYW50cy1saXN0XCIpO1xyXG4gIHVsLmlubmVySFRNTCA9IFwiXCI7XHJcblxyXG4gIC8vIFJlbW92ZSBhbGwgbWFwIG1hcmtlcnNcclxuICBpZiAobWFya2Vycykge1xyXG4gICAgbWFya2Vycy5mb3JFYWNoKG1hcmtlciA9PiBtYXJrZXIucmVtb3ZlKCkpO1xyXG4gIH1cclxuICBtYXJrZXJzID0gW107XHJcbiAgcmVzdGF1cmFudHMgPSByZXN0cztcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYWxsIHJlc3RhdXJhbnRzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuZmlsbFJlc3RhdXJhbnRzSFRNTCA9IChyZXN0cyA9IHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xyXG4gIHJlc3RzLmZvckVhY2gocmVzdCA9PiB7XHJcbiAgICB1bC5hcHBlbmQoY3JlYXRlUmVzdGF1cmFudEhUTUwocmVzdCkpO1xyXG4gIH0pO1xyXG4gIGFkZE1hcmtlcnNUb01hcCgpO1xyXG59XHJcblxyXG4vKipcclxuICogem9vbSBhbmQgbW92ZSBpbWFnZSBvbiBob3ZlclxyXG4gKi9cclxuaW1nSG92ID0gKHsgcGFnZVgsIHBhZ2VZLCB0YXJnZXQ6IGVsIH0pID0+IHtcclxuICBjb25zdCBvcmlnaW4gPSAoKHBhZ2VYIC0gZWwub2Zmc2V0TGVmdCkgLyBlbC53aWR0aCkgKiAxMDAgKyAnJSAnICsgKChwYWdlWSAtIGVsLm9mZnNldFRvcCkgLyBlbC5oZWlnaHQpICogMTAwICsgJyUnO1xyXG4gIGVsLnN0eWxlLmNzc1RleHQgPSAndHJhbnNmb3JtLW9yaWdpbjogJyArIG9yaWdpbjtcclxufVxyXG5cclxuZnVuY3Rpb24gSW1nRXJyb3IoKSB7XHJcbiAgdGhpcy5jbGFzc0xpc3QuYWRkKFwic3R5bGUtaW1hZ2UtYWx0XCIpO1xyXG4gIHRoaXMub25tb3VzZW1vdmUgPSBudWxsO1xyXG59XHJcbmZ1bmN0aW9uIHRvZ2dsZUZhdigpIHtcclxuICBjb25zdCBzdGF0ZSA9IHRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKFwieWVzXCIpO1xyXG4gIERCSGVscGVyLmZhdih0aGlzLmRhdGFzZXQuaWQsICFzdGF0ZSk7XHJcbiAgdGhpcy5jbGFzc0xpc3QudG9nZ2xlKFwieWVzXCIpO1xyXG4gIGNvbnN0IFthLCBiXSA9IHN0YXRlID8gW1wiYWRkXCIsIFwicmVtb3ZlXCJdIDogW1wicmVtb3ZlXCIsIFwiYWRkXCJdO1xyXG4gIHRoaXMuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCB0aGlzLmdldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIikucmVwbGFjZShhLCBiKSk7XHJcbn1cclxuLyoqXHJcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwuXHJcbiAqL1xyXG5jcmVhdGVSZXN0YXVyYW50SFRNTCA9IHJlc3QgPT4ge1xyXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpXCIpO1xyXG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgbGkuc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwgMCk7XHJcbiAgY29udGFpbmVyLmNsYXNzTmFtZSA9IFwiaW1nLWNvbnRhaW5lclwiO1xyXG5cclxuICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIik7XHJcbiAgaW1hZ2UuY2xhc3NOYW1lID0gXCJyZXN0YXVyYW50LWltZ1wiO1xyXG4gIGltYWdlLnNyYyA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0LnBob3RvZ3JhcGgpO1xyXG4gIGltYWdlLmFsdCA9IGBJbWFnZSBvZiAke3Jlc3QubmFtZX0gUmVzdGF1cmFudGA7XHJcbiAgaW1hZ2Uub25tb3VzZW1vdmUgPSBpbWdIb3Y7XHJcbiAgaW1hZ2Uub25lcnJvciA9IEltZ0Vycm9yO1xyXG5cclxuICBjb250YWluZXIuYXBwZW5kKGltYWdlKTtcclxuICBsaS5hcHBlbmQoY29udGFpbmVyKTtcclxuXHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoMlwiKTtcclxuICBuYW1lLmlubmVySFRNTCA9IHJlc3QubmFtZTtcclxuICBsaS5hcHBlbmQobmFtZSk7XHJcblxyXG4gIGNvbnN0IGZhdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcbiAgZmF2LnRleHRDb250ZW50ID0gXCLinaRcIjtcclxuICBsZXQgaXNGYXYgPSByZXN0LmlzX2Zhdm9yaXRlID8gSlNPTi5wYXJzZShyZXN0LmlzX2Zhdm9yaXRlKSA6IGZhbHNlO1xyXG4gIGNvbnN0IGxvY0ZhdnMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImxvY19yZXN0X2ZhdlwiKTtcclxuICBpZihsb2NGYXZzKSB7XHJcbiAgICBpc0ZhdiA9IEpTT04ucGFyc2UobG9jRmF2cylbcmVzdC5pZF0gfHwgaXNGYXY7XHJcbiAgfVxyXG4gIGZhdi5jbGFzc05hbWUgPSBcImlzLWZhdlwiICsgKGlzRmF2ID8gXCIgeWVzXCIgOiBcIlwiKTtcclxuICBmYXYuZGF0YXNldC5pZCA9IHJlc3QuaWQ7XHJcbiAgZmF2Lm9uY2xpY2sgPSB0b2dnbGVGYXY7XHJcbiAgZmF2LnNldEF0dHJpYnV0ZShcclxuICAgIFwiYXJpYS1sYWJlbFwiLFxyXG4gICAgYGNsaWNrIHRvICR7aXNGYXYgPyBcInJlbW92ZVwiIDogXCJhZGRcIn0gJHtyZXN0Lm5hbWV9IHRvIGZhdm9yaXRlYFxyXG4gICk7XHJcbiAgbmFtZS5hcHBlbmQoZmF2KTtcclxuXHJcbiAgY29uc3QgbmVpZ2hib3Job29kSFRNTCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xyXG4gIG5laWdoYm9yaG9vZEhUTUwuaW5uZXJIVE1MID0gcmVzdC5uZWlnaGJvcmhvb2Q7XHJcbiAgbGkuYXBwZW5kKG5laWdoYm9yaG9vZEhUTUwpO1xyXG5cclxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0LmFkZHJlc3M7XHJcbiAgbGkuYXBwZW5kKGFkZHJlc3MpO1xyXG5cclxuICBjb25zdCBtb3JlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7XHJcbiAgbW9yZS5pbm5lckhUTUwgPSBcIlZpZXcgRGV0YWlsc1wiO1xyXG4gIG1vcmUuaHJlZiA9IERCSGVscGVyLnVybEZvclJlc3RhdXJhbnQocmVzdCk7XHJcbiAgbW9yZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIGBDbGljayB0byBvcGVuICR7cmVzdC5uYW1lfSdzIGRldGFpbHMgcGFnZWApO1xyXG4gIGxpLmFwcGVuZChtb3JlKTtcclxuXHJcbiAgcmV0dXJuIGxpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEFkZCBtYXJrZXJzIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzIHRvIHRoZSBtYXAuXHJcbiAqL1xyXG5hZGRNYXJrZXJzVG9NYXAgPSAocmVzdHMgPSByZXN0YXVyYW50cykgPT4ge1xyXG4gIHJlc3RzLmZvckVhY2gocmVzdCA9PiB7XHJcbiAgICAvLyBBZGQgbWFya2VyIHRvIHRoZSBtYXBcclxuICAgIGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdCwgbmV3TWFwKTtcclxuICAgIG1hcmtlci5vbihcImNsaWNrXCIsIG9uQ2xpY2spO1xyXG4gICAgZnVuY3Rpb24gb25DbGljaygpIHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIub3B0aW9ucy51cmw7XHJcbiAgICB9XHJcbiAgICBtYXJrZXJzLnB1c2gobWFya2VyKTtcclxuICB9KTtcclxuXHJcbn1cclxuLyogYWRkTWFya2Vyc1RvTWFwID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XHJcbiAgICAvLyBBZGQgbWFya2VyIHRvIHRoZSBtYXBcclxuICAgIGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2VsZi5tYXApO1xyXG4gICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gbWFya2VyLnVybFxyXG4gICAgfSk7XHJcbiAgICBzZWxmLm1hcmtlcnMucHVzaChtYXJrZXIpO1xyXG4gIH0pO1xyXG59ICovXHJcblxyXG4iXX0=
