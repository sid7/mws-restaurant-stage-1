let restaurants,neighborhoods,cuisines;var newMap,markers=[];function ImgError(){this.classList.add("style-image-alt"),this.onmousemove=null}function toggleFav(){this.classList.toggle("yes");const[e,t]=this.classList.contains("yes")?["add","remove"]:["remove","add"];this.setAttribute("aria-label",this.getAttribute("aria-label").replace(e,t))}document.addEventListener("DOMContentLoaded",e=>{initMap(),fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods((e,t)=>{e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const s=document.createElement("option");s.innerHTML=e,s.value=e,t.append(s)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines((e,t)=>{e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const s=document.createElement("option");s.innerHTML=e,s.value=e,t.append(s)})}),initMap=(()=>{self.newMap=L.map("map",{center:[40.722216,-73.987501],zoom:12,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1Ijoic2lkNyIsImEiOiJjamp1OGJvd2QwMzAzM3ByejRnd2x2NXY4In0.fkA6CjOQbzCkLVqJ1Wm4lA",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),updateRestaurants()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),s=e.selectedIndex,a=t.selectedIndex,n=e[s].value,o=t[a].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(n,o,(e,t)=>{e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers&&self.markers.forEach(e=>e.remove()),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");e.forEach(e=>{t.append(createRestaurantHTML(e))}),addMarkersToMap()}),imgHov=(({pageX:e,pageY:t,target:s})=>{const a=(e-s.offsetLeft)/s.width*100+"% "+(t-s.offsetTop)/s.height*100+"%";s.style.cssText="transform-origin: "+a}),createRestaurantHTML=(e=>{const t=document.createElement("li"),s=document.createElement("div");t.setAttribute("tabindex",0),s.className="img-container";const a=document.createElement("img");a.className="restaurant-img",a.src=DBHelper.imageUrlForRestaurant(e.photograph),a.alt=`Image of ${e.name} Restaurant`,a.onmousemove=imgHov,a.onerror=ImgError,s.append(a),t.append(s);const n=document.createElement("h2");n.innerHTML=e.name,t.append(n);const o=document.createElement("button");o.textContent="❤";const r=JSON.parse(e.is_favorite);o.className="is-fav"+(r?" yes":""),o.onclick=toggleFav,o.setAttribute("aria-label",`click to ${r?"remove":"add"} ${e.name} to favorite`),n.append(o);const i=document.createElement("p");i.innerHTML=e.neighborhood,t.append(i);const l=document.createElement("p");l.innerHTML=e.address,t.append(l);const c=document.createElement("a");return c.innerHTML="View Details",c.href=DBHelper.urlForRestaurant(e),c.setAttribute("aria-label",`Click to open ${e.name}'s details page`),t.append(c),t}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.newMap);t.on("click",function(){window.location.href=t.options.url}),self.markers.push(t)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJuZXdNYXAiLCJtYXJrZXJzIiwiSW1nRXJyb3IiLCJ0aGlzIiwiY2xhc3NMaXN0IiwiYWRkIiwib25tb3VzZW1vdmUiLCJ0b2dnbGVGYXYiLCJ0b2dnbGUiLCJhIiwiYiIsImNvbnRhaW5zIiwic2V0QXR0cmlidXRlIiwiZ2V0QXR0cmlidXRlIiwicmVwbGFjZSIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiaW5pdE1hcCIsImZldGNoTmVpZ2hib3Job29kcyIsImZldGNoQ3Vpc2luZXMiLCJEQkhlbHBlciIsImVycm9yIiwiY29uc29sZSIsInNlbGYiLCJmaWxsTmVpZ2hib3Job29kc0hUTUwiLCJzZWxlY3QiLCJnZXRFbGVtZW50QnlJZCIsImZvckVhY2giLCJuZWlnaGJvcmhvb2QiLCJvcHRpb24iLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwidmFsdWUiLCJhcHBlbmQiLCJmaWxsQ3Vpc2luZXNIVE1MIiwiY3Vpc2luZSIsIkwiLCJtYXAiLCJjZW50ZXIiLCJ6b29tIiwic2Nyb2xsV2hlZWxab29tIiwidGlsZUxheWVyIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiYXR0cmlidXRpb24iLCJpZCIsImFkZFRvIiwidXBkYXRlUmVzdGF1cmFudHMiLCJjU2VsZWN0IiwiblNlbGVjdCIsImNJbmRleCIsInNlbGVjdGVkSW5kZXgiLCJuSW5kZXgiLCJmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QiLCJyZXNldFJlc3RhdXJhbnRzIiwiZmlsbFJlc3RhdXJhbnRzSFRNTCIsIm1hcmtlciIsInJlbW92ZSIsInVsIiwicmVzdGF1cmFudCIsImNyZWF0ZVJlc3RhdXJhbnRIVE1MIiwiYWRkTWFya2Vyc1RvTWFwIiwiaW1nSG92IiwicGFnZVgiLCJwYWdlWSIsInRhcmdldCIsImVsIiwib3JpZ2luIiwib2Zmc2V0TGVmdCIsIndpZHRoIiwib2Zmc2V0VG9wIiwiaGVpZ2h0Iiwic3R5bGUiLCJjc3NUZXh0IiwibGkiLCJjb250YWluZXIiLCJjbGFzc05hbWUiLCJpbWFnZSIsInNyYyIsImltYWdlVXJsRm9yUmVzdGF1cmFudCIsInBob3RvZ3JhcGgiLCJhbHQiLCJuYW1lIiwib25lcnJvciIsImZhdiIsInRleHRDb250ZW50IiwiaXNGYXYiLCJKU09OIiwicGFyc2UiLCJpc19mYXZvcml0ZSIsIm9uY2xpY2siLCJhZGRyZXNzIiwibW9yZSIsImhyZWYiLCJ1cmxGb3JSZXN0YXVyYW50IiwibWFwTWFya2VyRm9yUmVzdGF1cmFudCIsIm9uIiwid2luZG93IiwibG9jYXRpb24iLCJvcHRpb25zIiwidXJsIiwicHVzaCJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsWUFDRkMsY0FDQUMsU0FDRixJQUFJQyxPQUNBQyxRQUFVLEdBOEpkLFNBQVNDLFdBQ1BDLEtBQUtDLFVBQVVDLElBQUksbUJBQ25CRixLQUFLRyxZQUFjLEtBRXJCLFNBQVNDLFlBQ1BKLEtBQUtDLFVBQVVJLE9BQU8sT0FDdEIsTUFBT0MsRUFBR0MsR0FBS1AsS0FBS0MsVUFBVU8sU0FBUyxPQUFTLENBQUMsTUFBTyxVQUFZLENBQUMsU0FBVSxPQUMvRVIsS0FBS1MsYUFBYSxhQUFjVCxLQUFLVSxhQUFhLGNBQWNDLFFBQVFMLEVBQUdDLElBaEs3RUssU0FBU0MsaUJBQWlCLG1CQUFxQkMsSUFDN0NDLFVBQ0FDLHFCQUNBQyxrQkFNRkQsbUJBQXFCLE1BQ25CRSxTQUFTRixtQkFBbUIsQ0FBQ0csRUFBT3hCLEtBQzlCd0IsRUFDRkMsUUFBUUQsTUFBTUEsSUFFZEUsS0FBSzFCLGNBQWdCQSxFQUNyQjJCLDZCQVFOQSxzQkFBd0IsRUFBQzNCLEVBQWdCMEIsS0FBSzFCLGlCQUM1QyxNQUFNNEIsRUFBU1gsU0FBU1ksZUFBZSx3QkFDdkM3QixFQUFjOEIsUUFBUUMsSUFDcEIsTUFBTUMsRUFBU2YsU0FBU2dCLGNBQWMsVUFDdENELEVBQU9F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QTBCMkUsRUFBUSxTQUFXLFNBQVMzQixFQUFXdUIsb0JBQ2xGQSxFQUFLakQsT0FBT21ELEdBRVosTUFBTXhELEVBQWVkLFNBQVNnQixjQUFjLEtBQzVDRixFQUFhRyxVQUFZNEIsRUFBVy9CLGFBQ3BDOEMsRUFBR3pDLE9BQU9MLEdBRVYsTUFBTStELEVBQVU3RSxTQUFTZ0IsY0FBYyxLQUN2QzZELEVBQVE1RCxVQUFZNEIsRUFBV2dDLFFBQy9CakIsRUFBR3pDLE9BQU8wRCxHQUVWLE1BQU1DLEVBQU85RSxTQUFTZ0IsY0FBYyxLQU1wQyxPQUxBOEQsRUFBSzdELFVBQVksZUFDakI2RCxFQUFLQyxLQUFPekUsU0FBUzBFLGlCQUFpQm5DLEdBQ3RDaUMsRUFBS2pGLGFBQWEsOEJBQStCZ0QsRUFBV3VCLHVCQUM1RFIsRUFBR3pDLE9BQU8yRCxHQUVIbEIsSUFNVGIsZ0JBQWtCLEVBQUNqRSxFQUFjMkIsS0FBSzNCLGVBQ3BDQSxFQUFZK0IsUUFBUWdDLElBRWxCLE1BQU1ILEVBQVNwQyxTQUFTMkUsdUJBQXVCcEMsRUFBWXBDLEtBQUt4QixRQUNoRXlELEVBQU93QyxHQUFHLFFBQ1YsV0FDRUMsT0FBT0MsU0FBU0wsS0FBT3JDLEVBQU8yQyxRQUFRQyxNQUV4QzdFLEtBQUt2QixRQUFRcUcsS0FBSzdDIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHJlc3RhdXJhbnRzLFxyXG4gIG5laWdoYm9yaG9vZHMsXHJcbiAgY3Vpc2luZXNcclxudmFyIG5ld01hcFxyXG52YXIgbWFya2VycyA9IFtdXHJcblxyXG4vKipcclxuICogRmV0Y2ggbmVpZ2hib3Job29kcyBhbmQgY3Vpc2luZXMgYXMgc29vbiBhcyB0aGUgcGFnZSBpcyBsb2FkZWQuXHJcbiAqL1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKGV2ZW50KSA9PiB7XHJcbiAgaW5pdE1hcCgpOyAvLyBhZGRlZFxyXG4gIGZldGNoTmVpZ2hib3Job29kcygpO1xyXG4gIGZldGNoQ3Vpc2luZXMoKTtcclxufSk7XHJcblxyXG4vKipcclxuICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgYW5kIHNldCB0aGVpciBIVE1MLlxyXG4gKi9cclxuZmV0Y2hOZWlnaGJvcmhvb2RzID0gKCkgPT4ge1xyXG4gIERCSGVscGVyLmZldGNoTmVpZ2hib3Job29kcygoZXJyb3IsIG5laWdoYm9yaG9vZHMpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3JcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxmLm5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzO1xyXG4gICAgICBmaWxsTmVpZ2hib3Job29kc0hUTUwoKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCBuZWlnaGJvcmhvb2RzIEhUTUwuXHJcbiAqL1xyXG5maWxsTmVpZ2hib3Job29kc0hUTUwgPSAobmVpZ2hib3Job29kcyA9IHNlbGYubmVpZ2hib3Job29kcykgPT4ge1xyXG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xyXG4gIG5laWdoYm9yaG9vZHMuZm9yRWFjaChuZWlnaGJvcmhvb2QgPT4ge1xyXG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XHJcbiAgICBvcHRpb24uaW5uZXJIVE1MID0gbmVpZ2hib3Job29kO1xyXG4gICAgb3B0aW9uLnZhbHVlID0gbmVpZ2hib3Job29kO1xyXG4gICAgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogRmV0Y2ggYWxsIGN1aXNpbmVzIGFuZCBzZXQgdGhlaXIgSFRNTC5cclxuICovXHJcbmZldGNoQ3Vpc2luZXMgPSAoKSA9PiB7XHJcbiAgREJIZWxwZXIuZmV0Y2hDdWlzaW5lcygoZXJyb3IsIGN1aXNpbmVzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGYuY3Vpc2luZXMgPSBjdWlzaW5lcztcclxuICAgICAgZmlsbEN1aXNpbmVzSFRNTCgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogU2V0IGN1aXNpbmVzIEhUTUwuXHJcbiAqL1xyXG5maWxsQ3Vpc2luZXNIVE1MID0gKGN1aXNpbmVzID0gc2VsZi5jdWlzaW5lcykgPT4ge1xyXG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcclxuXHJcbiAgY3Vpc2luZXMuZm9yRWFjaChjdWlzaW5lID0+IHtcclxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xyXG4gICAgb3B0aW9uLmlubmVySFRNTCA9IGN1aXNpbmU7XHJcbiAgICBvcHRpb24udmFsdWUgPSBjdWlzaW5lO1xyXG4gICAgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBsZWFmbGV0IG1hcCwgY2FsbGVkIGZyb20gSFRNTC5cclxuICovXHJcbmluaXRNYXAgPSAoKSA9PiB7XHJcbiAgc2VsZi5uZXdNYXAgPSBMLm1hcCgnbWFwJywge1xyXG4gICAgICAgIGNlbnRlcjogWzQwLjcyMjIxNiwgLTczLjk4NzUwMV0sXHJcbiAgICAgICAgem9vbTogMTIsXHJcbiAgICAgICAgc2Nyb2xsV2hlZWxab29tOiBmYWxzZVxyXG4gICAgICB9KTtcclxuICBMLnRpbGVMYXllcignaHR0cHM6Ly9hcGkudGlsZXMubWFwYm94LmNvbS92NC97aWR9L3t6fS97eH0ve3l9LmpwZzcwP2FjY2Vzc190b2tlbj17bWFwYm94VG9rZW59Jywge1xyXG4gICAgbWFwYm94VG9rZW46ICdway5leUoxSWpvaWMybGtOeUlzSW1FaU9pSmphbXAxT0dKdmQyUXdNekF6TTNCeWVqUm5kMngyTlhZNEluMC5ma0E2Q2pPUWJ6Q2tMVnFKMVdtNGxBJyxcclxuICAgIG1heFpvb206IDE4LFxyXG4gICAgYXR0cmlidXRpb246ICdNYXAgZGF0YSAmY29weTsgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm9wZW5zdHJlZXRtYXAub3JnL1wiPk9wZW5TdHJlZXRNYXA8L2E+IGNvbnRyaWJ1dG9ycywgJyArXHJcbiAgICAgICc8YSBocmVmPVwiaHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LXNhLzIuMC9cIj5DQy1CWS1TQTwvYT4sICcgK1xyXG4gICAgICAnSW1hZ2VyeSDCqSA8YSBocmVmPVwiaHR0cHM6Ly93d3cubWFwYm94LmNvbS9cIj5NYXBib3g8L2E+JyxcclxuICAgIGlkOiAnbWFwYm94LnN0cmVldHMnXHJcbiAgfSkuYWRkVG8obmV3TWFwKTtcclxuXHJcbiAgdXBkYXRlUmVzdGF1cmFudHMoKTtcclxufVxyXG4vKiB3aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcclxuICBsZXQgbG9jID0ge1xyXG4gICAgbGF0OiA0MC43MjIyMTYsXHJcbiAgICBsbmc6IC03My45ODc1MDFcclxuICB9O1xyXG4gIHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcclxuICAgIHpvb206IDEyLFxyXG4gICAgY2VudGVyOiBsb2MsXHJcbiAgICBzY3JvbGx3aGVlbDogZmFsc2VcclxuICB9KTtcclxuICB1cGRhdGVSZXN0YXVyYW50cygpO1xyXG59ICovXHJcblxyXG4vKipcclxuICogVXBkYXRlIHBhZ2UgYW5kIG1hcCBmb3IgY3VycmVudCByZXN0YXVyYW50cy5cclxuICovXHJcbnVwZGF0ZVJlc3RhdXJhbnRzID0gKCkgPT4ge1xyXG4gIGNvbnN0IGNTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XHJcbiAgY29uc3QgblNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xyXG5cclxuICBjb25zdCBjSW5kZXggPSBjU2VsZWN0LnNlbGVjdGVkSW5kZXg7XHJcbiAgY29uc3QgbkluZGV4ID0gblNlbGVjdC5zZWxlY3RlZEluZGV4O1xyXG5cclxuICBjb25zdCBjdWlzaW5lID0gY1NlbGVjdFtjSW5kZXhdLnZhbHVlO1xyXG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IG5TZWxlY3RbbkluZGV4XS52YWx1ZTtcclxuXHJcbiAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kKGN1aXNpbmUsIG5laWdoYm9yaG9vZCwgKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXNldFJlc3RhdXJhbnRzKHJlc3RhdXJhbnRzKTtcclxuICAgICAgZmlsbFJlc3RhdXJhbnRzSFRNTCgpO1xyXG4gICAgfVxyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDbGVhciBjdXJyZW50IHJlc3RhdXJhbnRzLCB0aGVpciBIVE1MIGFuZCByZW1vdmUgdGhlaXIgbWFwIG1hcmtlcnMuXHJcbiAqL1xyXG5yZXNldFJlc3RhdXJhbnRzID0gKHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgLy8gUmVtb3ZlIGFsbCByZXN0YXVyYW50c1xyXG4gIHNlbGYucmVzdGF1cmFudHMgPSBbXTtcclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XHJcbiAgdWwuaW5uZXJIVE1MID0gJyc7XHJcblxyXG4gIC8vIFJlbW92ZSBhbGwgbWFwIG1hcmtlcnNcclxuICBpZiAoc2VsZi5tYXJrZXJzKSB7XHJcbiAgICBzZWxmLm1hcmtlcnMuZm9yRWFjaChtYXJrZXIgPT4gbWFya2VyLnJlbW92ZSgpKTtcclxuICB9XHJcbiAgc2VsZi5tYXJrZXJzID0gW107XHJcbiAgc2VsZi5yZXN0YXVyYW50cyA9IHJlc3RhdXJhbnRzO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFsbCByZXN0YXVyYW50cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmZpbGxSZXN0YXVyYW50c0hUTUwgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xyXG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XHJcbiAgICB1bC5hcHBlbmQoY3JlYXRlUmVzdGF1cmFudEhUTUwocmVzdGF1cmFudCkpO1xyXG4gIH0pO1xyXG4gIGFkZE1hcmtlcnNUb01hcCgpO1xyXG59XHJcblxyXG4vKipcclxuICogem9vbSBhbmQgbW92ZSBpbWFnZSBvbiBob3ZlclxyXG4gKi9cclxuaW1nSG92ID0gKHtwYWdlWCwgcGFnZVksIHRhcmdldDogZWx9KSA9PiB7XHJcbiAgY29uc3Qgb3JpZ2luID0gKChwYWdlWCAtIGVsLm9mZnNldExlZnQpIC8gZWwud2lkdGgpICogMTAwICsgJyUgJyArICgocGFnZVkgLSBlbC5vZmZzZXRUb3ApIC8gZWwuaGVpZ2h0KSAqIDEwMCArJyUnO1xyXG4gIGVsLnN0eWxlLmNzc1RleHQgPSAndHJhbnNmb3JtLW9yaWdpbjogJyArIG9yaWdpbjtcclxufVxyXG5cclxuZnVuY3Rpb24gSW1nRXJyb3IoKSB7XHJcbiAgdGhpcy5jbGFzc0xpc3QuYWRkKFwic3R5bGUtaW1hZ2UtYWx0XCIpO1xyXG4gIHRoaXMub25tb3VzZW1vdmUgPSBudWxsO1xyXG59XHJcbmZ1bmN0aW9uIHRvZ2dsZUZhdigpIHtcclxuICB0aGlzLmNsYXNzTGlzdC50b2dnbGUoXCJ5ZXNcIik7XHJcbiAgY29uc3QgW2EsIGJdID0gdGhpcy5jbGFzc0xpc3QuY29udGFpbnMoXCJ5ZXNcIikgPyBbXCJhZGRcIiwgXCJyZW1vdmVcIl0gOiBbXCJyZW1vdmVcIiwgXCJhZGRcIl07XHJcbiAgdGhpcy5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIHRoaXMuZ2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiKS5yZXBsYWNlKGEsIGIpKTtcclxufVxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTC5cclxuICovXHJcbmNyZWF0ZVJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQpID0+IHtcclxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgbGkuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIDApO1xyXG4gIGNvbnRhaW5lci5jbGFzc05hbWUgPSBcImltZy1jb250YWluZXJcIjtcclxuXHJcbiAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuICBpbWFnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcnO1xyXG4gIGltYWdlLnNyYyA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LnBob3RvZ3JhcGgpO1xyXG4gIGltYWdlLmFsdCA9IGBJbWFnZSBvZiAke3Jlc3RhdXJhbnQubmFtZX0gUmVzdGF1cmFudGA7XHJcbiAgaW1hZ2Uub25tb3VzZW1vdmUgPSBpbWdIb3Y7XHJcbiAgaW1hZ2Uub25lcnJvciA9IEltZ0Vycm9yO1xyXG5cclxuICBjb250YWluZXIuYXBwZW5kKGltYWdlKTtcclxuICBsaS5hcHBlbmQoY29udGFpbmVyKTtcclxuXHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcbiAgbGkuYXBwZW5kKG5hbWUpO1xyXG5cclxuICBjb25zdCBmYXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gIGZhdi50ZXh0Q29udGVudCA9IFwi4p2kXCI7XHJcbiAgY29uc3QgaXNGYXYgPSBKU09OLnBhcnNlKHJlc3RhdXJhbnQuaXNfZmF2b3JpdGUpO1xyXG4gIGZhdi5jbGFzc05hbWUgPSBcImlzLWZhdlwiICsgKGlzRmF2ID8gXCIgeWVzXCIgOiBcIlwiKTtcclxuICBmYXYub25jbGljayA9IHRvZ2dsZUZhdjtcclxuICBmYXYuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBgY2xpY2sgdG8gJHtpc0ZhdiA/IFwicmVtb3ZlXCIgOiBcImFkZFwifSAke3Jlc3RhdXJhbnQubmFtZX0gdG8gZmF2b3JpdGVgKVxyXG4gIG5hbWUuYXBwZW5kKGZhdik7XHJcblxyXG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBuZWlnaGJvcmhvb2QuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uZWlnaGJvcmhvb2Q7XHJcbiAgbGkuYXBwZW5kKG5laWdoYm9yaG9vZCk7XHJcblxyXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XHJcbiAgbGkuYXBwZW5kKGFkZHJlc3MpO1xyXG5cclxuICBjb25zdCBtb3JlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gIG1vcmUuaW5uZXJIVE1MID0gJ1ZpZXcgRGV0YWlscyc7XHJcbiAgbW9yZS5ocmVmID0gREJIZWxwZXIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuICBtb3JlLnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgYENsaWNrIHRvIG9wZW4gJHtyZXN0YXVyYW50Lm5hbWV9J3MgZGV0YWlscyBwYWdlYCk7XHJcbiAgbGkuYXBwZW5kKG1vcmUpXHJcblxyXG4gIHJldHVybiBsaVxyXG59XHJcblxyXG4vKipcclxuICogQWRkIG1hcmtlcnMgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMgdG8gdGhlIG1hcC5cclxuICovXHJcbmFkZE1hcmtlcnNUb01hcCA9IChyZXN0YXVyYW50cyA9IHNlbGYucmVzdGF1cmFudHMpID0+IHtcclxuICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xyXG4gICAgLy8gQWRkIG1hcmtlciB0byB0aGUgbWFwXHJcbiAgICBjb25zdCBtYXJrZXIgPSBEQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIHNlbGYubmV3TWFwKTtcclxuICAgIG1hcmtlci5vbihcImNsaWNrXCIsIG9uQ2xpY2spO1xyXG4gICAgZnVuY3Rpb24gb25DbGljaygpIHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIub3B0aW9ucy51cmw7XHJcbiAgICB9XHJcbiAgICBzZWxmLm1hcmtlcnMucHVzaChtYXJrZXIpO1xyXG4gIH0pO1xyXG5cclxufVxyXG4vKiBhZGRNYXJrZXJzVG9NYXAgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxyXG4gICAgY29uc3QgbWFya2VyID0gREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzZWxmLm1hcCk7XHJcbiAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsICgpID0+IHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIudXJsXHJcbiAgICB9KTtcclxuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcik7XHJcbiAgfSk7XHJcbn0gKi9cclxuXHJcbiJdfQ==
